\documentclass[12pt,twoside]{amsart}
\usepackage{amscd,amssymb,amsthm,amsmath,amsfonts,amscd,bm,enumerate,latexsym}
\usepackage[dvips]{graphicx}
\usepackage[all]{xy}
 
 \renewcommand{\subjclassname}{%
  \textup{2010} Mathematics Subject Classification} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Newtheorems

\newtheorem{theo}{Theorem}[section]
\newtheorem{prop}[theo]{Proposition}
\newtheorem{lem}[theo]{Lemma}
\newtheorem*{claim}{Claim}
\newtheorem*{subclaim}{Subclaim}
\newtheorem{conj}[theo]{Conjecture}
\newtheorem{cor}[theo]{Corollary}
\newtheorem{fact}[theo]{Fact}


\theoremstyle{definition}
\newtheorem{defi}[theo]{Definition}
\newtheorem{exmp}[theo]{Example}
\newtheorem{rem}[theo]{Remark}
\newtheorem{prob}[theo]{Problem}
\newtheorem{ques}[theo]{Question}
\newtheorem{step}{Step}
\newtheorem{defi-rem}[theo]{Definition-Remark}
\newtheorem{defi-lem}[theo]{Definition-Lemma}
\newtheorem{defi-prop}[theo]{Definition-Proposition}
\newtheorem{reminder}[theo]{Reminder}


 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Newcommands
 \newcommand\Nef{\mathop{\mathrm{Nef}}\nolimits}
 \newcommand\SA{\mathop{\mathrm{SA}}\nolimits}
 \newcommand\Pic{\mathop{\mathrm{Pic}}\nolimits}
 \newcommand\PicQ{\mathop{\mathrm{Pic}_{\bq}}\nolimits}
 \newcommand\Cl{\mathop{\mathrm{Cl}}\nolimits}
 \newcommand\Num{\mathop{\mathrm{N}^{1}}\nolimits}
 \newcommand\Mov{\mathop{\mathrm{Mov}}\nolimits}
 \newcommand\Eff{\mathop{\mathrm{Eff}}\nolimits}
 \newcommand\Ample{\mathop{\mathrm{Ample}}\nolimits}
 \newcommand\Vol{\mathop{\mathrm{Vol}}\nolimits}
 \newcommand\Hom{\mathop{\mathrm{Hom}}\nolimits}
\newcommand\Spec{\mathop{\mathrm{Spec}}\nolimits}
\newcommand\divi{\mathop{\mathrm{div}}\nolimits}
\newcommand\ev{\mathop{\mathrm{ev}}\nolimits}
\newcommand\Supp{\mathop{\mathrm{Supp}}\nolimits}
\newcommand\cha{\mathop{\mathrm{char}}\nolimits}
\newcommand\Divi{\mathop{\mathrm{Div}}\nolimits}
\newcommand\WDivi{\mathop{\mathrm{WDiv}}\nolimits}
\newcommand\Proj{\mathop{\mathrm{Proj}}}
\newcommand\ex{\mathop{\mathrm{ex}}}
\newcommand\Ex{\mathop{\mathrm{Ex}}}
\newcommand\Fan{\mathop{\mathrm{Fan}}}
\newcommand\st{\mathop{\mathrm{st}}}
\newcommand\id{\mathop{\mathrm{id}}}
 
 \newcommand\ab{\mathop{\mathbb{B}}_{+}}
 \newcommand\bn{\mathbb{N}}
 \newcommand\bz{\mathbb{Z}}
 \newcommand\bq{\mathbb{Q}} 
 \newcommand\br{\mathbb{R}}
 \newcommand\bc{\mathbb{C}}
 
 \newcommand\OO{\mathcal{O}}
 
 
 
 
 
 
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
 \begin{document}
 \title[]{On Images of Mori Dream Spaces}
 \author{Shinnosuke OKAWA}
 \address{Graduate School of Mathematical Sciences, 
the University of Tokyo, 3-8-1 Komaba, Meguro-ku, Tokyo 153-8914, Japan.}
\email{okawa@ms.u-tokyo.ac.jp}
\date{}
\subjclass[2010]{Primary 14L24; Secondary 13A50, 13A02}
\keywords{Mori dream space, Cox ring, VGIT}



\maketitle
 
 \begin{abstract}
%Although some ideas 
  The purpose of this paper is to study the geometry of the images of morphisms from Mori dream spaces.  
  Firstly we prove that a variety which admits a surjective morphism from a Mori dream space again is a MDS.
  Secondly we introduce a fan structure on the effective cone of a MDS
  and show that under a surjective morphism between MDSs the fan of the target space coincides with the
  restriction of the fan of the source.
  
  We see that this fan encodes some information of the Zariski decompositions, which
  in turn is equivalent to the information of the GIT equivalence of VGIT of the Cox ring.
  Corresponding to these two interpretations, two different proofs are given to the
  second theorem.
  
  Generalizations to non-$\bq$-factorial cases and to Mori dream regions are also treated.
 \end{abstract}

\tableofcontents




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%Introduction
\section{Introduction}
Throughout the paper, we work over an algebraically closed base field $k$ of characteristic
$p\ge 0$.


A Mori dream space (MDS for short), whose definition and many of its basic properties was first given
in the paper \cite{hk}, is a class of projective varieties with strong conditions on their line bundles.
On the other hand, as proven in \cite{hk}, MDS can also be characterized as a class of varieties
whose geometry of line bundles can be described
in terms of the Variation of Geometric Invariant Theory quotients (VGIT for short) of its Cox ring.

The purpose of this paper is to study the geometry of the images of morphisms from MDSs.
In the proofs of our results we use both of the two characterizations of MDSs mentioned above.

Our first result is the following

\begin{theo}\label{main}
Let $X,Y$ be normal $\bq$-factorial projective varieties, and $f: X\to Y$ be a surjective morphism.
If $X$ is a Mori dream space, then so is $Y$.
\end{theo}

We expect that Theorem \ref{main} will be useful to construct new examples of MDSs.

Here we explain the structure of the proof.
Theorem \ref{main} will be proven by checking that a Cox ring of $Y$ is of finite type over the base field
(see Fact \ref{characterization}).
We deduce it from the finite generation of a Cox ring of $X$. By taking the Stein factorization of
$f$, the proof is divided into two parts: the case when $f$ is an algebraic fiber space
(\S\ref{Finite generation of multi-section rings on MDS}) and the case when $f$ is a finite morphism (\S
\ref{Finite generation of multi-section rings under a finite morphism}).
A finite morphism will be further decomposed into the separable part and the purely inseparable part,
and treated independently (but with somewhat similar ideas). Combining them, Theorem \ref{main}
will be proven in \S\ref{Proof of Theorem main}.


Next we introduce a canonically defined fan structure on the effective cone of a MDS
(see Definition-Proposition \ref{def of fan}), and give it two interpretations.

One is from the view point of the Zariski decompositions of line bundles.
We say that two line bundles on a MDS are strongly Mori equivalent if the negative parts of their Zariski
decompositions have the same support and the positive parts define the same rational map
(see Definition \ref{strong Mori equivalence}). With this notion, we prove that
two line bundles on a MDS are strongly Mori equivalent if and only if they are contained in the
relative interior of the same cone of the fan (see \S\ref{Zariski decompositions and the fan}).

The other is in the view point of VGIT of Cox rings.
To a line bundle on a MDS we associate a character of the dual torus of the Picard group, which is
defined by evaluation, and we say that two line bundles on a MDS are GIT equivalent if
the semi-stable loci of the corresponding characters coincide (see \S\ref{MDS and GIT revisited}).
Then we show in \S\ref{Strong Mori equivalence = GIT equivalence} that two line bundles are GIT equivalent
if and only if they are strongly Mori equivalent, which in turn is equivalent to saying that they
belong to the relative interior of the same cone of the fan.


Now let $f:X\to Y$ be a surjective morphism between MDSs. We denote the fan of $X$ by
$\Fan{(X)}$ (resp. $\Fan{(Y)}$).
With the preparations above, we can show the comparison theorem of the fan of $Y$ with that of $X$.

To see this, note that we can
regard $\Pic{(Y)}_{\br}$ as a subspace of $\Pic{(X)}_{\br}$ via the natural injection
\begin{equation*}
f^{*}:\Pic{(Y)}_{\br}\to\Pic{(X)}_{\br},
\end{equation*}
so that we can restrict $\Fan{(X)}$ to the fan on $\Pic{(Y)}_{\br}$ by intersecting the cones of $\Fan{(X)}$
with $\Pic{(Y)}_{\br}$. Thus we can compare $\Fan{(Y)}$ with $\Fan{(X)}$,
and the answer turns out to be quite simple:

\begin{theo}\label{fans}
With the same assumptions as in Theorem \ref{main},
the fan of $Y$ coincides with the restriction of the fan of $X$ to the subspace $\Pic{(Y)}_{\br}\subset\Pic{(X)}_{\br}$: i.e.
\begin{equation*}
\Fan{(Y)}=\Fan{(X)}|_{\Pic{(Y)}_{\br}}
\end{equation*}
holds.
\end{theo}

See Example \ref{bl-up of P^3} for an illustration of Theorem \ref{fans}.

We give two proofs for Theorem \ref{fans} corresponding to the two characterizations of the
relative interiors of the cones explained above. These are treated respectively in
\S\ref{Comparison of the fans -without GIT-} and
\S\ref{Comparison of the fans -via GIT-}. In both of the proofs, Theorem \ref{finite} are repeatedly used.

In the final section, we extend our results to non-$\bq$-factorial MDSs and Mori dream regions.
As an example of Mori dream region, we discuss those cones spanned by finitely many
klt log canonical divisors (sometimes called a Shokurov polytope).
Our fan structure, in this context, reflects the information of log terminal models and log canonical models
(see \S\ref{Application to the Shokurov polytopes}).

Finally we note that our results are valid in arbitrary characteristics and even when the morphisms involved
are inseparable (see Example \ref{globally F-regular is not preserved}).


%%%%%%%%%%%%%%%%preceding results

There are relevant preceding results to Theorem \ref{main}.
In \cite{b}, it was shown that
the projective GIT quotient of an invariant open subset of a MDS
by an action of a reductive group is a MDS.
When $p=0$, it is also known (e.g. see \cite[Corollary 5.2]{fg}) that the image of a log Fano variety 
again is a log Fano variety. Recall that a log Fano variety is a MDS at least in characteristic zero
(\cite[Corollary 1.3.2]{bchm}).

In the paper \cite{hk}, they introduced a fan structure on the movable cone of a MDS. Our fan structure is
an extension of that one. Our descriptions of the relative interiors of the cones are not explicitly
treated in that paper, but the basic ideas needed for the proof implicitly appears in it. 






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\subsection*{Conventions}
Unless otherwise stated, any variety is assumed to be normal and satisfy $H^0(\OO)=k$.
The word ``stable'' means ``properly stable'' in the sense of \cite{git}: i.e.
we assume that the stabilizer subgroup of a stable point is finite.
For the notations and terminologies of MDSs and Cox rings we follow \cite{hk}, and
for those of (V)GIT we follow \cite{dh} and \cite{git} (except for the definition of stability, as
mentioned above).



\subsection*{Acknowledgements}
The author would like to express his gratitude to his advisor Professor Yujiro Kawamata
for many suggestions, especially for asking him about the positive characteristic case.
The author is indebted to Doctor Tadakazu Sawada for informing him of the paper
\cite{rs} and of examples of quotients by rational vector fields, and
to Professor Young-Hoon Kiem for his nice question.
He would also like to thank Doctors Yoshinori Gongyo, Atsushi Ito, and Akiyoshi Sannai for
stimulating discussions.

The author is supported by the Grant-in-Aid for Scientific Research
(KAKENHI No. 22-849) and the Grant-in-Aid for JSPS fellows.




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage

\section{Definition and basic properties of MDS}
\label{Definition and basic properties of MDS}
\subsection{Reminder}\label{Reminder}
In this section, we briefly recall the definition and some of the basic
properties of MDS which we need in this paper.
For details, see \cite{hk}. We follow the terminologies of the paper.

\begin{defi}\label{sqm}
Let $X$ be a normal projective variety. A small $\bq$-factorial modification (SQM, for short)
of $X$ is a small (i.e. isomorphic in codimension one) birational map
$f:X\dasharrow Y$ to another normal $\bq$-factorial projective variety $Y$.
\end{defi}


%%%%%%%Definition of MDS

\begin{defi}\label{MDS} 
A normal projective variety $X$ is called a Mori dream space
(MDS for short) provided that the following conditions hold:
\begin{enumerate}
\item $X$ is $\bq$-factorial, $\Pic{(X)}$ is finitely generated and
$\Pic{(X)}_{\bq} \simeq \Num{(X)}_{\bq}$ holds. \label{fin_pic}
\item $\Nef{(X)}$ is the affine hull of finitely many semi-ample
line bundles. \label{nef=sa}
\item There is a finite collection of SQMs $f_i: X \dasharrow X_i$
such that each $X_i$ satisfies (\ref{fin_pic})(\ref{nef=sa}) and $\Mov{(X)}$ is the union
of the $f_i^*(\Nef{(X_i)})$.\label{movable cone condition}
\end{enumerate}
\end{defi}

\begin{rem}
The author is not sure if the assumption that the morphism
$\Pic{(X)}_{\bq} \to \Num{(X)}_{\bq}$ is isomorphic follows from the finite generation of $\Pic{(X)}$.
We note here that it is the case at least when the base field $k$ has uncountably many elements.
In fact, finite generation of $\Pic{(X)}$ implies that of $\Pic^{0}{(X)}$. If $k$ is uncountable, we see that
$\Pic^{0}_{X/k}$, the connected component of the identity of the Picard scheme of $X$, should be zero dimensional.
Hence $\Pic^{0}(X)$ is a point. By \cite[Corollary 9.6.17]{fga}, the finiteness of $\Pic^{tors}{(X)}$, the subgroup of
torsion elements of $\Pic{(X)}$, follows from this. By \cite[Theorem 9.6.3]{fga} and \cite[Exercise 9.6.11]{fga},
a numerically trivial line bundle should be torsion in this case.
Thus we see that $\Pic{(X)}_{\bq} \to \Num{(X)}_{\bq}$ is isomorphic.

When $k=\mathbb{C}$, the assumption $q=h^{1}(\mathcal{O}_X)=0$ is equivalent to saying that $\Pic{(X)}$ is
finitely generated.
In general, we only have the inequality $\dim\Pic{(X)}\le q$
(see \cite[Corollary 9.5.13 and Remark 9.5.15]{fga}.)
\end{rem}


Let $X$ be a normal projective variety satisfying the condition (\ref{fin_pic}) of Definition \ref{MDS}.
We start with recalling the definition of Mori chambers (see \cite[Definition 1.3 and 1.4]{hk}):

\begin{defi}
Let $D_1$ and $D_2$ be
two $\bq$-Cartier divisors on $X$ with finitely generated
section rings.
Then we say $D_1$
and $D_2$ are Mori equivalent if the rational maps 
\begin{equation*}
\varphi_{D_i}:X\dasharrow \Proj{(R_{X}(\OO_X(D_i)))} \ (i=1,2)
\end{equation*}
are isomorphic: i.e. if there is an isomorphism between their target spaces which makes
the obvious triangular diagram commutative.
\end{defi}
Note that the rational map $\varphi_{D_i}$ above is the same as the Iitaka
fibration of $D_i$ (in the sense of \cite[Theorem 2.1.33]{l}).

\begin{defi}\label{Mori chamber}
A Mori chamber of $X$ is the closure of a Mori equivalence class in $\Pic{(X)}_{\br}$
with non-empty interior.
\end{defi}


\cite[Proposition 1.11 (2)]{hk} gives the natural decomposition of
the effective cone of a MDS into Mori chambers:

\begin{prop}\label{[Proposition 1.11 (2)]{hk}}
There are finitely many contracting birational maps $g_i:X\dasharrow Y_i$, with
$Y_i$ a MDS, such that
\begin{equation*}
\Eff{(X)}=\bigcup_{i}g_i^{*}\SA{(Y_i)}*\ex{(g_i)}
\end{equation*}
gives a decomposition of the effective cone into closed rational polyhedral subcones with
disjoint interiors. Each $g_i^{*}\SA{(Y_i)}*\ex{(g_i)}$ is a Mori chamber of $X$.
\end{prop}

Above $\ex{(g_i)}$ denotes the cone spanned by the exceptional prime divisors of $g_i$, and
$g_i^{*}\SA{(Y_i)}*\ex{(g_i)}$ denotes the join of the cones $g_i^{*}\SA{(Y_i)}$ and $\ex{(g_i)}$.
We use the notation $*$ to indicate that any element of the cone $g_i^{*}\SA{(Y_i)}*\ex{(g_i)}$
is written uniquely as the sum of the elements of the cones $g_i^{*}\SA{(Y_i)}$ and $\ex{(g_i)}$.

Here we point out some properties of the cone $\ex{(g_i)}$.
\begin{lem}\label{negative cone}
For any integral divisor $E\in\ex{(g_i)}$, $h^0(X,\OO_X(E))=1$.
Moreover $\ex{(g_i)}$ is simplicial and its extremal rays are
those cones spanned by an exceptional prime divisor of $g_i$.
In particular $N_1,N_2\in\ex{(g_i)}$ has the same support if and only if
they are contained in the relative interior of the same face of $\ex{(g_i)}$.
\end{lem}
\begin{proof}
For any $g_i$ exceptional effective divisor $E$, the natural map
$\OO_{Y_i}\to g_{i*}\OO_{X}(E)$ is isomorphic. The first claim follows
from this. The second and the third claims follow from the first one.
\end{proof}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{The fan of MDS}\label{The fan of MDS}

Next we introduce a fan structure on the effective cone of a MDS:
\begin{defi-prop}\label{def of fan}
Let $X$ be a MDS. The set of faces of Mori chambers of $X$ forms a fan whose support coincides with
the effective cone of $X$. We denote it by $\Fan{(X)}$.
\end{defi-prop}
\begin{rem}
The fan structure on $\Eff{(X)}$ defined above is the extension of that on $\Mov{(X)}$
introduced in \cite[Proposition 1.11(3)]{hk}.
\end{rem}
\begin{proof}
All we have to show is that the intersection of two cones of $\Fan{(X)}$ is a face of each cone.
Let $\sigma_1,\sigma_2\in\Fan{(X)}$ be two cones. We show that $\sigma_1\cap\sigma_2$ is
a face of $\sigma_2$.

By the definition of a face, there exists classes of curves $\ell_i\in N_1(X)_{\br}
\cong N^{1}(X)_{\br}^{\vee}$ ($i=1,2$) such that
\begin{equation*}
\mathcal{C}_i\subseteq\ell_{i}^{\ge 0}=\{D\in N^{1}(X)_{\br}|D.\ell_i\ge 0\}
\end{equation*}
and
\begin{equation*}
\sigma_{i}=\mathcal{C}_i\cap\ell_{i}^{\perp}
\end{equation*}
holds for $i=1,2$.

Consider the following sequence of inclusions
\begin{equation*}
\sigma_1\cap\sigma_2=(\mathcal{C}_1\cap\mathcal{C}_2\cap\ell_2^{\perp})\cap\ell_1^{\perp}
\subset\mathcal{C}_1\cap\mathcal{C}_2\cap\ell_2^{\perp}\subset
\mathcal{C}_1\cap\mathcal{C}_2\subset\mathcal{C}_2.
\end{equation*}
From this we see that it is enough to show that $\mathcal{C}_1\cap\mathcal{C}_2$ is a face
of $\mathcal{C}_2$, since we know that a face of a face again is a face (see \cite[page 10(4)]{f2}).

Let $g_i:X\dasharrow Y_i$ ($i=1,2$) be the contracting birational map corresponding to $\mathcal{C}_i$.
We know that $\mathcal{C}_i=\mathcal{P}_i*\mathcal{N}_i$, where
$\mathcal{P}_i=g_i^{*}\SA{(Y_i)}$ and $\mathcal{N}_i=\ex{(g_i)}$.

We divide the proof into the following claims:
\begin{claim}
\begin{enumerate}
\item $\mathcal{C}_1\cap\mathcal{C}_2=(\mathcal{P}_1\cap\mathcal{P}_2)*
(\mathcal{N}_1\cap\mathcal{N}_2)$.
\item $\mathcal{P}_1\cap\mathcal{P}_2$ is a face of $\mathcal{P}_2$.
\item $\mathcal{N}_1\cap\mathcal{N}_2$ is a face of $\mathcal{N}_2$.
\item $\mathcal{C}_1\cap\mathcal{C}_2$ is a face of $\mathcal{C}_2$.
\end{enumerate}
\end{claim}
\begin{proof}
(4) follows from (1)(2)(3). (1) follows from the uniqueness of the Zariski decomposition of line bundles
on a MDS (see Proposition \ref{ZD}).
(2) is stated in \cite[Proposition 1.11(3)]{hk}. 
We check (3). Let $A=\sum a_iE_i$ ($a_i\ge 0$) and $B=\sum b_iE_i$ ($b_i\ge 0$) be
two elements of $\mathcal{N}_2$ such that $A+B\in\mathcal{N}_1$.
By Lemma \ref{negative cone} $h^{0}(X,\mathcal{O}(E))=1$ holds for any $E\in\mathcal{N}_1$, which means that
$\Supp{(A+B)}\subset \Ex{(g_1)}$. Hence we see $\Supp{(A)},\Supp{(B)}\subset \Ex{(g_1)}$,
concluding the proof.
\end{proof}
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\subsection{Zariski decompositions and the fan}\label{Zariski decompositions and the fan}

Next we give an explicit description for the Zariski decompositions (in the sense of Cutkosky-Kawamata-Moriwaki)
of line bundles on a MDS, which turns out to characterize MDSs\footnote{the author would like to thank Prof.
Y.-H. Kiem for asking him if it could be the case.}:

%%%%Zariski decomposition for MDS

\begin{prop}\label{ZD}
Let $X$ be a MDS. Consider the decomposition of $\Eff{(X)}$ into
the Mori chambers as in Proposition \ref{[Proposition 1.11 (2)]{hk}}:
\begin{equation*}
\Eff{(X)}=\bigcup_{\textrm{finite}}\mathcal{C}.
\end{equation*}
Then for each chamber $\mathcal{C}$ there exists a small $\bq$-factorial modification
$f_i:X\dasharrow X_i$ of $X$ and two $\bq$-linear maps
\begin{equation*}
P,N:\mathcal{C}\to \Eff{(X)}
\end{equation*}
such that for any $\bz$-divisor $D\in \mathcal{C} $,
$D\sim_{\bq}P(D)+N(D)$ gives the Zariski decomposition of $D$ as a
divisor on $X_i$; i.e.
\begin{itemize}
\item
$P(D)\in\SA{(X_i)}$.
\item
$N(D)\ge 0$.
\item
The natural map
\begin{equation}\label{ZD map}
H^0(X,\OO_X(mP(D)))\to H^0(X,\mathcal{O}_X(mD)),
\end{equation}
which is defined by multiplication of a non-zero global section of
the line bundle $\mathcal{O}_X(mN(D))$
is isomorphic for every sufficiently divisible positive integer $m$.
\end{itemize}

Zariski decomposition of $D$ is unique up to $\bq$-linear equivalence.

Conversely a normal projective variety satisfying Definition \ref{MDS} (\ref{fin_pic})
and having a decomposition of its effective cone into finitely many chambers $\mathcal{C}$
on which Zariski decompositions are $\bq$-linear actually is a MDS.
\end{prop}

\begin{proof}
Let $\mathcal{C}$ be a Mori chamber. Then we have a birational contraction
$g_i:X\dasharrow Y_i$ to another MDS $Y_i$.
We can replace $X$ with one of its SQMs so that $g_i$ becomes a morphism
by (\ref{movable cone condition}) of Definition \ref{MDS}.
Now we define the maps $P,N$ as follows:
\begin{itemize}
\item $P(D)=g_i^{*}g_{i*}D$.
\item $N(D)=D-P(D)$.
\end{itemize}
By Lemma \ref{negative cone} $h^{0}(X,\mathcal{O}_X(mN(D)))=1$
holds for all sufficiently divisible
positive integer $m$. Thus the map ($\ref{ZD map}$) is uniquely defined up to constant.
When $m$ is sufficiently divisible so that $mP(D)$ is a $\bz$-divisor,
it is easy to see that this map has the required properties.

The uniqueness of the Zariski decomposition follows from the fact that the positive parts are movable.

The last statement can be shown by checking the finite generation of a Cox ring via exactly the
same argument as in Lemma \ref{afs}.

\end{proof}


Here we check that the Zariski decomposition is compatible with the pull-back of
line bundles:

\begin{lem}\label{ZD under pull-back}
Let $f:X\to Y$ be a surjective morphism between MDSs.
Let $D=P+N$ be the Zariski decomposition of an effective divisor $D$ on $Y$.
Then $f^{*}D=f^{*}P+f^{*}N$ gives the Zariski decomposition of $f^{*}D$.
\end{lem}
\begin{proof}
By Lemma \ref{direct} (2), $f^{*}P$ is movable. Therefore it is enough to show that
the natural mapping
\begin{equation*}
H^0(X,\OO_X(mf^{*}P))\xrightarrow[]{\otimes f^{*}s_N^{\otimes m}}H^0(X,\OO_X(mf^{*}D))
\end{equation*}
is an isomorphism for sufficiently divisible $m>0$, where $s_N\in H^0(Y,\OO_Y(N))$ is
a non-zero section corresponding to the divisor $N$.

Replacing $X$ and $Y$ with their SQMs, if necessary, we may assume that
$P$ and $f^{*}P$ are semi-ample. 
Let $c:Y\to Z$ be a birational morphism which is responsible for the Zariski decomposition
of $D$: i.e. suppose that $D\in c^{*}\SA{(Z)}*\ex{(c)}$. Take the Stein factorization
\begin{equation*}
X\xrightarrow[]{g}\tilde{Y}\xrightarrow[]{h}Y 
\end{equation*}
of $f$, and let $\tilde{c}:\tilde{Y}\to\tilde{Z}$ be the birational morphism obtained via the
Stein factorization of the morphism $c\circ h:\tilde{Y}\to Z$. We obtain the following commutative diagram:

%diagram
\[
\xymatrix{
X \ar[rd] \ar[d]_{g} & \\
\tilde{Y} \ar[r]_{\tilde{c}} \ar[d]_{h} & \tilde{Z} \ar[d]^{h_Z} \\
Y \ar[r]_{c} & Z \\}\]

Since $g$ is an algebraic fiber space, the space of global sections of a line bundle on $\tilde{Y}$ does not change
under pull-back by $g$. Hence it is enough to show that the following mappings are
surjective:
\begin{equation*}
\mu:H^0(\tilde{Y},\OO_{\tilde{Y}}(mh^{*}P))\xrightarrow[]{\otimes h^{*}s_N^{\otimes m}}H^0(\tilde{Y},\OO_{\tilde{Y}}(mh^{*}D)).
\end{equation*}

Take $D'\in |mh^{*}D|$. Then we see that
$D'=\tilde{c}^{*}\tilde{c}_{*}D'+(D'-\tilde{c}^{*}\tilde{c}_{*}D')$ gives the Zariski decomposition of $D'$, and a
section corresponding to the semi-ample divisor $\tilde{c}^{*}\tilde{c}_{*}D'$ is mapped via $\mu$ to a section
corresponding to $D'$ up to scalar multiplication, concluding the proof.
\end{proof}


Now we define a stronger version of the Mori equivalence relation, which is closely related to
the fan of MDSs defined above:
\begin{defi}\label{strong Mori equivalence}
Let $X$ be a MDS. Two line bundles $L, M$ are said to be strongly Mori equivalent if
they are Mori equivalent and
\begin{equation*}
\Supp{(N(L))}=\Supp{(N(M))}
\end{equation*}
holds, where $N(L)$ (resp. $N(M)$) is the negative part of the Zariski decomposition of $L$ (resp. $M$).
\end{defi}

\begin{prop}\label{fan vs strong Mori equivalence}
For a MDS $X$, a strong Mori equivalence class coincides with the relative interior of a cone of
$\Fan{(X)}$ and vice versa.
\end{prop}
\begin{proof}
Let $\mathcal{C}$ be a Mori chamber and let $\mathcal{C}=\mathcal{P}*\mathcal{N}$ be the Zariski
decomposition of the chamber. By an elementary fact on convex cones, the join of a face of $\mathcal{P}$
with a face of $\mathcal{N}$ is a face of $\mathcal{C}$, and any face of $\mathcal{C}$ is of this form.
Moreover if $C$ is a face of $\mathcal{C}$ and $C=P*N$ is the decomposition,
\begin{equation*}
C^{relint}=P^{relint}*N^{relint}
\end{equation*}
holds.

Recall also that the relative interior of a face of $P$ is a strong Mori equivalence class.
This follows from the fact that two semi-ample line bundles are Mori equivalent if and only if
the set of curves contracted by the morphisms coincide.

The same thing also holds for $N$ by Lemma \ref{negative cone}.

Now Proposition \ref{fan vs strong Mori equivalence} follows immediately from these facts.


\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%Finite generation of multi-section rings on MDS
\section{Finite generation of multi-section rings on MDS}\label{Finite generation of multi-section rings on MDS}

We first prepare the notation for multi-section rings.

\begin{defi}\label{multi-section ring}
Let $X$ be a normal variety with $H^0(X,\OO_{X})=k$.
Let $\Gamma\subset\WDivi{(X)}$ be a sub-semigroup of Weil divisors. The
multi-section ring $R_X(\Gamma)$ associated to $\Gamma$ is
the $\Gamma$-graded $k$-algebra defined by
\begin{equation*}
R_X(\Gamma)=\bigoplus_{D\in\Gamma}H^0(X,\mathcal{O}_X(D)).
\end{equation*}
Similarly for a divisor $D$ on $X$, we define the section ring of $D$ by
\begin{equation*}
R_{X}(\OO_X(D))=\bigoplus_{m\ge 0}H^0(X,\mathcal{O}_X(mD)).
\end{equation*}
\end{defi}

In this section we prove the finiteness of multi-section rings on a MDS.
This has first been proven in \cite[Theorem 1.2]{b} by using the finite generation theorem for
invariant subrings. Our proof is based on the Zariski decompositions on MDSs, hence
is more geometric.

\begin{lem}\label{afs}
Let $X$ be a MDS. Let $\Gamma\subset\WDivi{(X)}$ be a finitely generated group of Weil divisors.
Then the multi-section ring $R_X(\Gamma)$ is of finite type over $k$.
More generally, for any open subset $U\subset X$, $R_{U}(\Gamma|_{U})$ is of finite type over $k$.
\end{lem}
\begin{proof}
We may assume that the natural map $\Gamma\to\Divi{(X)}_{\bq}$ is injective. To see this
we borrow some ideas from \cite{b}.

In general we can find a splitting $\Gamma=\Gamma_0\oplus\Gamma_1$ such that $\Gamma_0$
coincides with the kernel of $\Gamma\to\Divi{(X)}_{\bq}$. Then we see
\begin{equation*}
R_{X}(\Gamma)\cong R_{X}(\Gamma_{1})[\Gamma_{0}].
\end{equation*}
Note that $\Gamma_{1}$ maps injectively to $\Pic{(X)}_{\bq}$ and that $\Gamma_{0}$ is a finitely generated
free abelian group. Thus we may assume $\Gamma=\Gamma_1$.

Let $\mathcal{C}$ be a Mori chamber.
Set $\Gamma_{\mathcal{C}}=\Gamma\cap \mathcal{C}$. Note that it is a finitely generated semigroup.
Let $g_i:X\dasharrow Y_i$ be the birational map corresponding to $\mathcal{C}$.

Recall from the proof of Proposition \ref{ZD} that for all $D\in\Gamma_{\mathcal{C}}$
\begin{equation*}
D=g_i^{*}g_{i*}D+(D-g_i^{*}g_{i*}D),
\end{equation*}
as an equality of $\bq$-divisors, gives the Zariski decomposition of $D$.
Since $\Gamma$ is finitely generated and there are only finitely many Mori chambers,
there exists a positive integer $m>0$ such that
for any Mori chamber $\mathcal{C}$ and $D\in (m\Gamma)_{\mathcal{C}}$,
the positive and the negative parts of the above decomposition are both $\bz$-divisors.

We can replace $\Gamma$ with $m\Gamma$, since
$R_{X}(m\Gamma)\subset R_{X}(\Gamma)$ is finite.


With these preparations, we can compute $R_X(\Gamma_{\mathcal{C}})$ as follows:
\begin{equation*}
R_X(\Gamma_{\mathcal{C}})\cong R_{Y}(P(\Gamma_{\mathcal{C}}))[N(\Gamma_{\mathcal{C}})].
\end{equation*}
We construct an isomorphism $\varphi$ from the LHS to the RHS.
Choose $0\not=s_D\in H^0(X,\mathcal{O}_X(D))$ for each $D\in N(\Gamma_\mathcal{C})$
such that $s_D\otimes s_{D'}=s_{D+D'}$ holds for all $D,D'$.
Given $s\in H^0(X,\mathcal{O}_X(D))$, where $D\in\Gamma_\mathcal{C}$, set
\begin{equation*}
\varphi{(s)}=s\otimes s_{N(D)}^{-1}\chi^{N(D)}.
\end{equation*}
Above $\chi^{N(D)}$ is the monomial corresponding to $N(D)\in N(\Gamma_\mathcal{C})$.
Due to the property of the Zariski decompositions,
$\varphi$ is an isomorphism.

Now since $P(\Gamma_\mathcal{C})$ is a finitely generated semigroup of semi-ample divisors, and 
$N(\Gamma_\mathcal{C})$ is a finitely generated semigroup, we see that $R_X(\Gamma_\mathcal{C})$ is
of finite type over $k$ (see \cite[Lemma 2.8]{hk}).

Since there are only finitely many chambers, $R_X(\Gamma)$ itself is finitely generated
over $k$ (by the union of finite sets of generators for each $R_X(\Gamma_\mathcal{C})$). 

Finally, the conclusion for general open subsets $U$ follows from the case when $U=X$ (see the final part
of the proof of \cite[Theorem 1.2]{b}). Note that this is the only place we need the finite generation theorem
for invariant subrings.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%Case for Finite morphisms
\section{Finite generation of multi-section rings under a finite morphism}
\label{Finite generation of multi-section rings under a finite morphism}
In this section we prove that finite generation of multi-section rings is invariant
under finite morphisms.


\begin{theo}\label{finite}
Let $f:X\to Y$ be a finite surjective morphism.
Let $\Gamma\subset \WDivi{(Y)}$ be a finitely generated semigroup of Weil divisors.
Then the natural morphism of multi-section rings $R_Y(\Gamma)\subset R_X(f^{*}\Gamma)$ is finite if
one of the rings is of finite type over $k$.
Moreover, $R_Y(\Gamma)$ is of finite type over $k$ if and only if $R_X(f^{*}\Gamma)$ is.
\end{theo}

See Definition \ref{multi-section ring} for the definition of multi-section rings.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Preliminary for the proof of Theorem \ref{finite}}
\label{Preliminary for the proof of Theorem finite}

In the proof of Theorem \ref{finite}, we frequently use universal torsors. We prepare some
notations here.

\begin{defi}\label{universal torsor}
Let $\Gamma\subset \WDivi{(Y)}$ be a finitely generated semigroup of Weil divisors.
We set
\begin{equation*}
\mathcal{S}_Y(\Gamma)=\bigoplus_{D\in\Gamma}\mathcal{O}_Y(D),
\end{equation*}
and call it the universal torsor associated to $\Gamma$.
\end{defi}
%Remarks
\begin{rem}\label{remarks on universal torsor}
 \ 
 
\begin{enumerate}
%1
\item\label{R_X and S_X} Note that
\begin{equation*}
H^0(Y,\mathcal{S}_Y)=\bigoplus_{D\in\Gamma}H^0(Y,\mathcal{O}_{Y}(D))=R_{Y}(\Gamma)
\end{equation*}
holds.
%2 
\item\label{removable}
$R_{Y}(\Gamma)$ does not change if we replace $Y$ with the non-singular locus of $Y$.
When $f:X\to Y$ is a finite morphism, we may assume that $X,Y$ are non-singular by removing suitable
closed subsets of codimensions at least two.
Hence we will freely assume that the varieties involved are non-singular.
%3
\item\label{flat} Note that if we assume that $Y$ is non-singular, then $\mathcal{S}_Y$ is a flat $\mathcal{O}_Y$ module.
%4
\item\label{S_X} $R_X(f^{*}\Gamma)=H^0(Y,f_{*}\mathcal{S}_X(f^{*}\Gamma))$, and we can calculate
\begin{equation*}
f_{*}\mathcal{S}_X(f^{*}\Gamma)=f_{*}\bigoplus_{D\in\Gamma}\mathcal{O}_X(f^{*}D)\cong\bigoplus_{D\in\Gamma}
\mathcal{O}_Y(D)\otimes_{\mathcal{O}_Y}f_{*}\mathcal{O}_X
=\mathcal{S}_Y(\Gamma)\otimes_{\mathcal{O}_Y}f_{*}\mathcal{O}_X.
\end{equation*}
\end{enumerate}
\end{rem}

\vspace{5mm}

Now we go back to the proof Theorem \ref{finite}. `if' part of the second claim follows
from the first claim, so we prove the first claim of Theorem \ref{finite} and the `only if' part of its
second claim.

Let
\begin{equation}
X\xrightarrow[]{g}\tilde{Y}\xrightarrow[]{h}Y 
\end{equation}
be the decomposition of $f$ into the purely inseparable part $g$
and the separable part $h$ (i.e. $\tilde{Y}$ is the normalization of $Y$
in the separable closure of $k(Y)$ in $k(X)$.)

Therefore we may assume that $f$ is either purely inseparable or separable.
We treat each case separately in the following two subsections, although the ideas are basically the same.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%insep
\subsection{Purely inseparable case}\label{Purely inseparable case}

Assume that $f$ is a purely inseparable morphism. 
We can divide the extension $k(Y)\subset k(X)$ into
subextensions of degree $p$, so that we may assume that $\deg{(f)}=p$.

The key idea for this case
is to describe $f$ as a ``uniform geometric quotient'' by an action of a rational
vector field on $X$:

\begin{prop}\label{insep_quot}
Let $f:X\to Y$ be a finite surjective morphism of degree $p$ between
normal varieties. Then there exists a rational vector field on $X$
i.e. $\delta\in Der_{k{(Y)}}k{(X)}$ such that
\begin{equation*}
\OO_{Y}=\OO_{X}^{\delta}:=\{f\in\OO_{X}|\delta f=0\}
\end{equation*}
holds. Moreover this quotient is uniform; i.e.
for a flat morphism $Z\to Y$, set $W=X\times_{Y}Z$ and
$\delta_Z=\delta\otimes_{\OO_{Y}}1_{\OO_Z}$. Then
\begin{equation}\label{uniform}
\OO_{Z}=\OO_{W}^{\delta_Z}
\end{equation}
holds.
\end{prop}

\begin{proof}
First half is well-known (see \cite[p. 1206]{rs}). We check the uniformity (\ref{uniform}).

Consider the following sequence of $\OO_{Y}$ modules, which is exact by definition:
\begin{equation}\label{der}
0\to\OO_{Y}\to\OO_{X}\xrightarrow[]{\delta}k(X)
\end{equation}
(since $f$ is finite, we dropped $f_{*}$).
Since $Z$ is flat over $Y$, by tensoring $\otimes_{\OO_{Y}}\OO_Z$ with
(\ref{der}) we obtain
\begin{equation*}
0\to\OO_{Z}\to\OO_{W}\xrightarrow[]{\delta_Z}k(X)\otimes_{\OO_{Y}}\OO_Z,
\end{equation*}

concluding the proof.

\end{proof}

\begin{cor}\label{insep_fin}
With the same notations as in Proposition \ref{insep_quot},
assume that $Z$ and $W$ are both normal varieties. Then
\begin{equation*}
H^0(W,\mathcal{O}_W)^{p}\subseteq H^0(Z,\mathcal{O}_Z)\subseteq
H^0(W,\mathcal{O}_W)
\end{equation*}
holds. In particular
$H^0(W,\mathcal{O}_W)$ is of finite type over $k$ if and only if $H^0(Z,\mathcal{O}_Z)$ is, and
in that case $H^0(Z,\mathcal{O}_Z)\subseteq
H^0(W,\mathcal{O}_W)$ is finite.
\end{cor}
\begin{proof}
By Proposition \ref{insep_quot}, we see that $W\to Z$ is a quotient by the induced
vector field $\delta_Z$ on $W$. Therefore
\begin{equation*}
\mathcal{O}_Z=(\mathcal{O}_W)^{\delta_Z}
\end{equation*}
holds. Since a derivation kills the $p$-th powers of functions,
\begin{equation*}
\mathcal{O}_W^p\subseteq(\mathcal{O}_W)^{\delta_Z}=\mathcal{O}_Z
\end{equation*}
holds. Taking $H^0$, we obtain the proof for the first line.

Next note that if $R$ is an algebra of finite type over $k$, then
$R^p$ also is of finite type over $k$ and $R$ is a finitely generated module
over $R^p$. `only if' part of the second line follows from this.
To see `if' part, note that the extension $k(W)\subset k(Z)$ is finite and
$Z$ is an integral extension of $W$.
\end{proof}




\begin{proof}[Proof of Theorem \ref{finite} when $f$ is purely inseparable]

\ 

Suppose that $f$ is purely inseparable. As mentioned before, we may assume that $\deg{(f)}=p$.

Note that we have a natural inclusion $\mathcal{S}_Y(\Gamma)\subset f_{*}\mathcal{S}_X(f^{*}\Gamma)$
of quasi-coherent sheaves of $\mathcal{O}_Y$ algebras,
which in turn is the product of the natural map
$\mathcal{O}_Y\subset f_{*}\mathcal{O}_X$ with $\textrm{id}_{\mathcal{S}_Y(\Gamma)}$
(Remark \ref{remarks on universal torsor} (\ref{S_X})).

By Remark \ref{remarks on universal torsor} (\ref{removable})(\ref{flat}),
we may assume that $X,Y$ are non-singular and hence
$\mathcal{S}_Y(\Gamma)$ is an affine space bundle over $\mathcal{O}_Y$.

Therefore we can apply Corollary \ref{insep_fin} for $f:X\to Y$ and the morphism
$Z:=\mathcal{S}pec_{\OO_Y}\mathcal{S}_Y(\Gamma)\to Y$.
Since $H^0(Z,\OO_Z)=R_Y(\Gamma)$ and $H^0(W,\OO_W)=R_X(f^{*}\Gamma)$
(see Remark \ref{remarks on universal torsor} (\ref{R_X and S_X}) and (\ref{S_X})),
we obtain the desired conclusions.
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%separable
\subsection{Separable case}\label{Separable case}

Assume that $f$ is separable. This case is relatively easier; by
passing to a Galois closure, we can describe $Y$ as a uniform geometric
quotient by the Galois group, so that we can apply
the finite generation theorem for invariant subrings.

\begin{proof}[Proof of Theorem \ref{finite} when $f$ is separable]
Suppose that $f$ is separable.
Let $k(W)$ be the Galois closure of $k(Y)\subset k(X)$, and let $W$ be the
normalization of $X$ in $k(W)$. If we denote by $G$ the Galois group of $W/Y$,
we see that $G$ acts on $W$ and $Y\cong W/G$.
By removing suitable closed subsets, we assume that $X,Y,W$ are all non-singular.

Since $W/X$ also is Galois, it is the uniform geometric quotient of the action of $Gal{(W/X)}$
on $W$. Since $\mathcal{S}_X{(\Gamma)}$ is locally free on $X$, it is a flat $\mathcal{O}_X$
algebra, and hence we have
\begin{equation*}
\mathcal{S}_X{(\Gamma)}=\mathcal{S}_W{(\Gamma)}^{Gal(W/X)}.
\end{equation*}
In particular we see that
$R_X(\Gamma)=R_W(\Gamma)^{Gal(W/X)}$.
Therefore $R_W(\Gamma)$ is an integral extension of
$R_X(\Gamma)$.

Suppose that $R_X(\Gamma)$ is of finite type over $k$.
By the finiteness theorem for integral closures, we see
$R_W(\Gamma)$ also is of finite type over $k$.

Similarly, we can show that
$R_Y(\Gamma)=R_W(\Gamma)^{G}$.
Since $G$ is a finite group, we obtain the finiteness of $R_Y(\Gamma)$.

Finally, the finiteness of $R_Y(\Gamma)\subset R_X(f^{*}\Gamma)$ follows from these
descriptions, concluding the proof.
\end{proof}







%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%Proof of Main Theorem

\section{Proof of Theorem \ref{main}}\label{Proof of Theorem main}

We prove Theorem \ref{main} by the following fact, which roughly says that the
finite generation of the Cox ring characterizes MDSs:

\begin{fact}\label{characterization}
\cite[Proposition 2.9]{hk} says that a normal projective variety satisfying
Definition \ref{MDS} (\ref{fin_pic}) is a MDS if and only if a Cox ring of the variety is of finite type over $k$.
\end{fact}



%%%%Finiteness of the dimension of Pic(Y)

First of all, we check the condition (\ref{fin_pic}) of Definition \ref{MDS} for $Y$;
\begin{lem}\label{pic}
Under the same assumption as Theorem \ref{main},
$\Pic{(Y)}$ is finitely generated and $\Pic{(Y)}_{\bq} \simeq \Num{(Y)}_{\bq}$ holds.
\end{lem}
\begin{proof}
Let
\begin{equation*}
X\xrightarrow[]{g}\tilde{Y}\xrightarrow[]{h}Y 
\end{equation*}
be the Stein factorization of $f$.
Let $L\in\Pic{(Y)}$ be a numerically trivial line bundle. Then
$f^{*}L$ is also numerically trivial by the projection formula of intersection theory.
By the assumption, there exists a positive integer $m$ such that $f^{*}L^{\otimes m}\cong\mathcal{O}_X$.
By taking $g_{*}$ and using the projection formula, we see that $h^{*}L^{\otimes m}\cong\mathcal{O}_Y$.
Now suppose $L\cong\mathcal{O}(D)$ for a Cartier divisor $D$. Since $h$ is a finite morphism, we have
$h_*h^{*}D\sim\deg{(h)}D$. Hence $m\deg{(h)}D\sim h_*h^{*}mD\sim 0$. Thus we checked the
second claim.

In order to show that the finite generation of $\Pic{(Y)}$, consider the following diagram:

%diagram
\[\xymatrix{
0 \ar[r]& \Pic^{tors}{(Y)} \ar[r] \ar[d]_{f^{*}} & \Pic{(Y)} \ar[r] \ar[d]_{f^{*}} & \Pic^{free}{(Y)} \ar[r] \ar[d]_{f^{*}} & 0\\
0 \ar[r]& \Pic^{tors}{(X)} \ar[r]  & \Pic{(X)} \ar[r]  & \Pic^{free}{(X)} \ar[r] & 0}\]

In the diagram above, $\Pic^{tors}{(X)}$ is the torsion part of $\Pic{(X)}$ and $\Pic^{free}{(X)}$ is the quotient of
$\Pic{(X)}$ by $\Pic^{tors}{(X)}$.

Using the similar arguments as above, we can show that the group homomorphism
$f^{*}:\Pic^{free}{(Y)}\to\Pic^{free}{(X)}$ is injective. Hence we see that $\Pic^{free}{(Y)}$ is finitely generated.

Finally we see the finiteness of the torsion part.
As we checked, there exists a non-zero constant $m$ such that for any numerically trivial line bundle $L$ on $Y$
$L^{\otimes m}\cong \OO_Y$ holds.
 This means that
$\Pic^0{(Y)}$ is contained in the subgroup of $m$-division points of $\Pic^0{(Y)}$, which is a finite set
since $\Pic^0_{Y/k}$ with its reduced structure is an abelian variety (see \cite[Remark 9.5.25]{fga}).
Together with \cite[Corollary 9.6.17]{fga}, the finiteness of $\Pic^{tors}{(Y)}$ follows.
\end{proof}

\begin{rem}
Using similar arguments we can directly check the following lemma, which are worth noting.

For a surjective morphism $f:X\to Y$ between normal projective varieties,
$f^{*}:\Pic{(Y)}_{\br}\to\Pic{(X)}_{\br}$ is injective. We regard $\Pic{(Y)}_{\br}$ as
a subspace of $\Pic{(X)}_{\br}$ via the mapping $f^{*}$. Then

\begin{lem}\label{direct}
With the same assumptions
as in Theorem \ref{main}, the following equalities hold:
\begin{enumerate}
\item
$\Nef{(Y)} = \Nef{(X)}\cap \Pic{(Y)}_{\br}=\SA{(X)}\cap\Pic{(Y)}_{\br}=\SA{(Y)}.$

\item
$\Mov{(Y)}=\Mov{(X)}\cap\Pic{(Y)}_{\br}
=\bigcup_{i}(\SA{(X_i)}\cap\Pic{(Y)}_{\br})$.

\item
$\Eff{(Y)}=\Eff{(X)}\cap\Pic{(Y)}_{\br}$.
\end{enumerate}
\end{lem}
\end{rem}


Now we go back to the proof of Theorem \ref{main}.
\begin{proof}[Proof of Theorem \ref{main}]
By Lemma \ref{pic} and Fact \ref{characterization},
it is enough to show the finiteness of a Cox ring of $Y$.

Set $\Gamma\subset\Divi{(Y)}$ be a finitely generated subgroup of rank $\rho{(Y)}$
whose image in $\Pic{(Y)}$ is of finite index.
By Lemma \ref{afs}, we know that $R_X(f^{*}\Gamma)$
is of finite type over $k$. On the other hand
\begin{equation*}
R_X(f^{*}\Gamma)\cong R_{\tilde{Y}}(h^{*}\Gamma)
\end{equation*}
holds, since $g$ is an algebraic fiber space.
Since $h$ is finite, by Theorem \ref{finite} we see that $R_Y(\Gamma)$ is of finite type over $k$.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section{Comparison of the fans -without GIT-}\label{Comparison of the fans -without GIT-}

In this section we prove Theorem \ref{fans} via direct arguments.
The problem is reduced to the following
\begin{theo}\label{comparing strong Mori equivalence}
Let $f:X\to Y$ be a surjective morphism between MDSs.
Then two line bundles $L$ and $M$ on $Y$ are strongly Mori equivalent
if and only if $f^{*}L$ and $f^{*}M$ are
strongly Mori equivalent.
\end{theo}

See Definition \ref{strong Mori equivalence} for the notion of strong Mori equivalence.

We first check that Theorem \ref{fans} actually follows from this.
\begin{proof}[Proof of Theorem \ref{fans}]
Take any $\sigma\in\Fan{(Y)}$. By Proposition \ref{fan vs strong Mori equivalence} and Theorem \ref{fans},
there exists a cone $\Sigma\in\Fan{(X)}$ such that
\begin{equation*}
\sigma^{relint}=\Sigma^{relint}\cap\Pic{(Y)}_{\br}
\end{equation*}
holds. Since RHS is not empty, we can check
\begin{equation*}
\sigma=\overline{\left(\Sigma^{relint}\cap\Pic{(Y)}_{\br}\right)}=\Sigma\cap\Pic{(Y)}_{\br}.
\end{equation*}
Conversely, let $\Sigma\in\Fan{(X)}$ be a cone which intersects with $\Pic{(Y)}_{\br}$.
Let $\Sigma'$ be the largest face of $\Sigma$ such that
\begin{equation*}
\Sigma\cap\Pic{(Y)}_{\br}=\Sigma'\cap\Pic{(Y)}_{\br}
\end{equation*}
holds. Note that
$\Sigma'^{relint}\cap\Pic{(Y)}_{\br}\not=\emptyset$ holds.

Again by Proposition \ref{fan vs strong Mori equivalence} and Theorem \ref{fans},
there exists a cone $\sigma\in\Fan{(Y)}$ such that 
\begin{equation*}
\Sigma'^{relint}\cap\Pic{(Y)}_{\br}=\sigma^{relint}.
\end{equation*}
Taking the closures, we obtain
\begin{equation*}
\Sigma\cap\Pic{(Y)}_{\br}=\Sigma'\cap\Pic{(Y)}_{\br}=\sigma.
\end{equation*}
\end{proof}

\begin{proof}[Proof of Theorem \ref{comparing strong Mori equivalence}]
In view of Lemma \ref{ZD under pull-back}, it is enough to show the following claim:
\begin{claim}\label{comparing Mori equivalence}
$L, M$ are Mori equivalent if and only if $f^{*}L$ and $f^{*}M$ are
Mori equivalent.
\end{claim}

Let
\begin{equation*}
f^{*}L,f^{*}M\in\Eff{(X)}\cap f^{*}\Pic{(Y)}_{\br}
\end{equation*}
be Mori equivalent line bundles.
We prove that $L,M$ are Mori equivalent.

First of all, take the Stein factorization of $f$:
\begin{equation*}
X\xrightarrow[]{g}\tilde{Y}\xrightarrow[]{h}Y.
\end{equation*}

Consider the following diagram.
%diagram
\[
\xymatrix{
\Proj{R_{X}(f^{*}M)} \ar[rr]_{\sim} \ar[dd]_{\cong} & & \Proj{R_{X}(f^{*}L)} \ar[dd]_{\cong}\\
& X \ar@{-->}[lu]^{\varphi_{f^{*}M}} \ar@{-->}[ru]_{\varphi_{f^{*}L}} \ar[dd]^{g}& \\
\Proj{R_{\tilde{Y}}(h^{*}M)}   & & \Proj{R_{\tilde{Y}}(h^{*}L)} \\
& \tilde{Y} \ar@{-->}[lu]^{\varphi_{h^{*}M}} \ar@{-->}[ru]_{\varphi_{h^{*}L}} & \\}\]

In the diagram above, the top horizontal arrow is an isomorphism which makes the
upper triangle commutative, whose existence is guaranteed since $f^*L$ and $f^*M$ are
Mori equivalent.
Note that the two side vertical morphisms are isomorphisms, since $g$ is an
algebraic fiber space.

Now it is easy to see that the isomorphism
from $\Proj{R_{\tilde{Y}}(h^{*}M)}$ to $\Proj{R_{\tilde{Y}}(h^{*}L)}$ which is obtained by
composing the three isomorphisms in the diagram is compatible with the rational maps
$\varphi_{h^*M}$ and $\varphi_{h^*L}$.

Therefore we obtain the following diagram.

%diagram
\[
\xymatrix{
\Proj{R_{\tilde{Y}}(h^{*}M)} \ar[rr]_{\sim} \ar[dd] & & \Proj{R_{\tilde{Y}}(h^{*}L)}  \ar[dd]\\
& \tilde{Y} \ar@{-->}[lu]^{\varphi_{h^{*}M}} \ar@{-->}[ru]_{\varphi_{h^{*}L}} \ar[dd]^{h}& \\
\Proj{R_{Y}(M)}   & & \Proj{R_{Y}(L)} \\
& Y \ar@{-->}[lu]^{\varphi_{M}} \ar@{-->}[ru]_{\varphi_{L}} & \\}\]

In the diagram above, the top horizontal arrow is the isomorphism obtained as above, hence
the top triangle is commutative.
We can show that the two side vertical morphisms are finite, since $h$ is.
In fact, by Theorem \ref{finite} $R_{\tilde{Y}}(h^{*}L)$ is finite
over $R_{Y}(L)$  (take as $\Gamma$ the free abelian group generated by $L$.
Then $R_{Y}(L)=R_Y(\Gamma)$ holds). The finiteness of the morphism $\Proj{R_{\tilde{Y}}(h^{*}L)}\to
\Proj{R_{Y}(L)}$ follows from this.

 
Finally, there exists an isomorphism from $\Proj{R_{Y}(M)}$ to $\Proj{R_{Y}(L)}$
which are compatible with any other maps.
In order to prove this, recall the following decomposition of the morphism $h$ from
\S\ref{Finite generation of multi-section rings under a finite morphism}:

%diagram
\[
\xymatrix{
 & W \ar[d] \ar[rd] &\\
\tilde{Y} \ar[r] & S \ar[r] & Y\\}\].

In the diagram above, $S$ is the separable closure of $\tilde{Y}/Y$ and $W$ is the Galois closure
of $S/Y$.

The function field of $\Proj{R_{Y}(M)}$, as a subfield of the function field
of $\Proj{R_{\tilde{Y}}(h^{*}M)}$, can be obtained by repeatedly taking the subfields of elements killed by
vector fields which corresponds to a chain of degree $p$ subextensions of $\tilde{Y}\to S$ (see Proposition \ref{insep_quot}),
taking the algebraic closure in $k(W)$ (see \cite[Example 2.1.12]{l}),
and taking the fields of invariants by the Galois group $G(W/Y)$
(see the arguments in \S\ref{Separable case}).
Note that these vector fields and Galois extensions depend only on the function fields
of $\Proj{R_{\tilde{Y}}(h^{*}M)}$, $\tilde{Y}$ and $Y$. Therefore
$\Proj{R_{Y}(M)}$ and $\Proj{R_{Y}(L)}$ should be isomorphic compatibly with the isomorphism
between $R_{\tilde{Y}}(h^{*}M)$ and $R_{\tilde{Y}}(h^{*}L)$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Conversely, take two Mori equivalent line bundles $L, M$ on $Y$. We show that $f^{*}L$ and $f^{*}M$ are
Mori equivalent. For this, we can trace back the arguments above.

Consider the following diagram:

%diagram
\[
\xymatrix{
\Proj{R_{\tilde{Y}}(h^{*}M)} \ar[dd] & & \Proj{R_{\tilde{Y}}(h^{*}L)}  \ar[dd]\\
& \tilde{Y} \ar@{-->}[lu]^{\varphi_{h^{*}M}} \ar@{-->}[ru]_{\varphi_{h^{*}L}} \ar[dd]^(0.3){h}& \\
\Proj{R_{Y}(M)} \ar[rr]^(0.4){\cong}_(0.4){\iota}  & & \Proj{R_{Y}(L)} \\
& Y \ar@{-->}[lu]^{\varphi_{M}} \ar@{-->}[ru]_{\varphi_{L}} & \\}\]

In the diagram above, the bottom horizontal arrow $\iota$ is an isomorphism which makes the bottom
triangle commutative. The existence of such an isomorphism is guaranteed by the Mori equivalence
of $L$ and $M$.

Note that the function field
$k(\Proj{R_{\tilde{Y}}(h^{*}L)})$ is the algebraic closure of $k(\Proj{R_{Y}(L)})$ in $k(X)$.
The same thing holds for $M$,
so we see that the two function fields $k(\Proj{R_{\tilde{Y}}(h^{*}L)})$ and $k(\Proj{R_{\tilde{Y}}(h^{*}M)})$
coincide as subfields of $k(X)$. 

By Theorem \ref{finite}, three vertical morphisms are finite. Hence we see that
$\Proj{R_{\tilde{Y}}(h^{*}L)}$ (resp. $\Proj{R_{\tilde{Y}}(h^{*}M)}$) is the normalization of
$\Proj{R_{Y}(L)}$ (resp. $\Proj{R_{Y}(M)}$) in the same subfield of $k(\tilde{Y})$.Therefore the isomorphism $\iota$
lifts to an isomorphism between $\Proj{R_{\tilde{Y}}(h^{*}L)}$ and $\Proj{R_{\tilde{Y}}(h^{*}M)}$
making everything commutative. Since $g:X\to\tilde{Y}$ is an algebraic fiber space,
this isomorphism guarantees the equivalence of $f^*L$ and $f^*M$, concluding the proof.


\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{MDS and GIT revisited}\label{MDS and GIT revisited}

In this section, we re-establish the relation between the variation of GIT quotients (VGIT for short)
and the geometry of MDSs. To be precise, we give an explicit description for VGIT of actions of
tori on affine varieties with torsion divisor class groups. After that
we establish the correspondence 
between the fan structure defined above, and the GIT chambers and cells. The results of this section
will be used later in the proof of Theorem \ref{fans} via GIT.

\begin{rem}
In \cite{hk} they quote the results on VGIT from the paper \cite{dh}, 
in which every variety under an action by a reductive group is assumed to be proper.
On the other hand for MDSs we have to deal with actions on the affine varieties defined
by Cox rings, hence we need another version: namely, VGIT for affine varieties.
One big difference is that for a 1-PS $\lambda$ the limit
$\lim_{t\to 0}\lambda (t)x$ does not exist in general. As a consequence, the wall defined by
a point may not be a convex set, contrary to the proper case.
In \cite{hk} the correspondence between the GIT chambers and the Mori chambers is stated.
In this paper we refine this correspondence as the equivalence of
GIT equivalence with strong Mori equivalence.
\end{rem}

\subsection{VGIT of torus actions on affine varieties}
\label{VGIT of torus actions on affine varieties}
The purpose of this subsection is to give an explicit description
for the VGIT of actions of algebraic tori on affine varieties.

First we fix some notations.

Let $G$ be a reductive group acting on an affine variety $V$. Assume for simplicity that
only finitely many elements of $G$ acts on $V$ trivially.

We denote by $\chi{(G)}$ the space of characters of $G$, and by $\chi_{\bullet}{(G)}$ the
space of 1-parameter subgroups of $G$. Note that there is a natural pairing
\begin{equation*}
\langle \chi, \lambda\rangle=n,
\end{equation*}
where $\chi\in\chi{(G)}$, $\lambda\in\chi_{\bullet}{(G)}$ and $(\chi\circ\lambda)(t)=t^{n}$.

In the rest of this paper, for a character $\chi\in\chi{(G)}$
we denote by $U_{\chi}:=V^{ss}(L_{\chi})$ the semi-stable locus
of $V$ with respect to the linearization $L_{\chi}$, the linearized
line bundle on $V$ whose underlying line bundle is trivial and the action of $G$ is
given by the formula 
\begin{equation*}
(g\cdot f)(x)=\chi{(g)}f(g^{-1}x)
\end{equation*}
for $g\in G$, $f\in \OO_V$ and $x\in V$.

We denote by $q_{\chi}:U_{\chi}\to Q_{\chi}=U_{\chi}//G$ the quotient map.


Now we recall the numerical criterion for affine varieties \cite[Proposition 2.5]{k}:

\begin{prop}\label{King}
Let $G$, $V$ as above. Let $\chi\in\chi (G)$ be
a character of $G$. Then 
\begin{enumerate}
\item $x\in V$ is $L_{\chi}$ semi-stable $\iff$
$\langle \chi, \lambda\rangle\ge 0$ holds 
for any 1-PS
$\lambda\in\chi_{\bullet}(G)\setminus\{0\}$
such that $\lim_{t\to 0}\lambda (t)\cdot x$ exists.

\item $x\in V$ is $L_{\chi}$ stable $\iff$
$\langle \chi, \lambda\rangle> 0$ holds 
for any 1-PS $\lambda\in\chi_{\bullet}(G)\setminus\{0\}$
such that $\lim_{t\to 0}\lambda (t)\cdot x$ exists.
\end{enumerate}
\end{prop}

We rephrase this criteria in the case when $G$ is an algebraic torus $T$.
Let $V\subset \mathbb{A}$ be a $T$-equivariant embedding of $V$ into
an affine space.
It is well-known that $\mathbb{A}$ admits a weight decomposition
$\mathbb{A}=\bigoplus_{\chi\in\chi{(T)}}\mathbb{A}_{\chi}$, where
$\mathbb{A}_{\chi}=\{x\in\mathbb{A}|g\cdot x=\chi{(g)}x \ \forall \ g\in T\}$.

Take a point $x\in V$. According to the decomposition above,
there exists a unique decomposition $x=\sum x_{\chi}$. Now since $V$ is closed in $\mathbb{A}$,
we see

$\begin{array}{ll}
& \lim_{t\to 0}\lambda (t)\cdot x \ \ \textrm{exists in V} \\
\iff & \lim_{t\to 0}\lambda (t)\cdot x \ \ \textrm{exists in $\mathbb{A}$} \\
\iff & \langle \chi, \lambda\rangle\ge 0 \ \ \forall \ \chi \ \textrm{such that} \ x_{\chi}\not=0. \\
\end{array}$

Let $\st{(x)}=\{\chi\in\chi{(T)}|x_{\chi}\not=0\}\subset\chi{(T)}$ be the state set of the point $x\in V$.
Note that there are only finitely many possibility for the set $\st{(x)}$, since it is a subset of the
finite set $\st{(\mathbb{A})}=\{\chi\in\chi{(T)}|\mathbb{A}_{\chi}\not=0\}$.

Denote by $\mathcal{D}_x\subset\chi{(T)}_{\br}$ the cone spanned by $\st{(x)}$. Then
\begin{prop} For a character $\chi\in\chi{(T)}$, 
\begin{enumerate}
\item $x\in V$ is semi-stable with respect to $L_{\chi}$ if and only if
$\chi\in\mathcal{D}_x$ holds.

\item $x\in V$ is stable with respect to $L_{\chi}$ if and only if
$\chi\in\mathcal{D}_x^{\circ}$, where $\mathcal{D}_x^{\circ}$ denotes the interior
of the set $\mathcal{D}_x$ (possibly empty).
\end{enumerate}
\end{prop}

\begin{proof}
This is almost tautological. From Proposition \ref{King} and the argument above,
$x\in V$ is semi-stable with respect to $\chi$ if and only if $\langle \chi, \lambda\rangle\ge 0$
holds for all 1-PS $\lambda$ which is semi-positive definite on the cone $\mathcal{D}_{x}$:
i.e. the set of such characters $\chi$ is the double dual cone of the cone $\mathcal{D}_{x}$.
Since $\mathcal{D}_{x}$ is rational polyhedral, the double dual coincides with
itself by \cite[(1) on page 9]{f2}.

Stable case can be checked similarly.
\end{proof}

Set $C=C^{T}(V)=\bigcup_{x\in V}\mathcal{D}_x$. 
We define the following notions according to \cite{dh}.
\begin{defi}
A wall defined by $x\in V$ is the set $\partial\mathcal{D}_x$.
A GIT chamber is a connected component of the set
$C\setminus\bigcup_{x\in V}\partial\mathcal{D}_x$.

Two characters $\chi,\chi'$ are said to be wall equivalent if
$V^{sss}(\chi)=V^{sss}(\chi')$ holds. 
A connected component
of a wall equivalence class, which is not a chamber, is called
a (GIT) cell.

\end{defi}

\begin{defi}\label{VGIT notions}
Two characters $\chi,\chi'$ are said to be GIT equivalent
if $V^{ss}(\chi)=V^{ss}(\chi')$ holds.
\end{defi}


Via similar arguments as in \cite[Theorem 3.3.2]{dh} and \cite[Lemma 3.3.10]{dh},
we can check the following
\begin{lem}\label{VGIT lemmas}
\begin{enumerate}
\item A GIT chamber is a GIT equivalence class.
\item For any GIT chamber $\mathcal{C}$,
\begin{equation*}
\mathcal{C}=\bigcap_{x\in V^{s}(\mathcal{C})}\mathcal{D}_{x}^{\circ}
\end{equation*}
holds.
\item A cell is contained in a GIT equivalence class.\label{cell to GIT equivalence}
\end{enumerate}
\end{lem}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\subsection{Strong Mori equivalence $=$ GIT equivalence}
\label{Strong Mori equivalence = GIT equivalence}

Let $X$ be a MDS, and fix a Cox ring $R=R_X(\Gamma)$, where
$\Gamma$ is a finitely generated group of Weil divisors as usual.

The purpose of this subsection is to show that the following three kinds
of sets are the same:
\begin{itemize}
\item the relative interior of a cone of $\Fan{(X)}$.
\item a strong Mori equivalence class.
\item a GIT equivalence class.
\end{itemize}
In the paper \cite{hk}, they proved this fact only for the cones of maximal dimension.  We need the
refined version as above for the two proofs of Theorem \ref{fans}.

We first recall some basic facts about the relationship between MDS and VGIT (see \cite{hk} for detail).
\begin{reminder}\label{reminder of GIT description}


Set $V_X=\Spec{(R_X(\Gamma))}$.
Recall that the torus $T_X:=Hom_{gp}(\Gamma, k^{*})$ acts naturally on $V_X$ as follows:
for any element $g\in T$, a divisor $D\in\Gamma$ and $f\in H^0(X,\OO_X{(D)})$,
set
\begin{equation*}
g\cdot f=g(D)f.
\end{equation*}

As stated in \cite[Theorem 2.3]{hk}, we have a natural isomorphism
\begin{equation*}
\psi: \chi{(T_X)}_{\br}\to\Gamma_{\br}\cong\Pic{(X)}_{\br}
\end{equation*}
in such a way that $D\in\Gamma$ corresponds to the character $ev_{D}:g\mapsto g(D)$.
 
For any $D\in\Gamma$, it is easy to see that $Q_{\ev_D}=\Proj_{X}(\OO_X(D))$.
In particular, if we take an ample $A\in\Gamma$, $q_{\ev_A}=\id_X$ holds.

By the universal property of categorical quotients, we obtain the rational map
\begin{equation*}
X=Q_{\ev_A}\dasharrow Q_{\ev_D},
\end{equation*}
and it is easy to see that this coincides with the rational map
$\varphi_{\OO_X(D)}:X\dasharrow\Proj{(R_X(\OO_X(D)))}$.
\end{reminder}


Now we can state our main observation:
\begin{prop}\label{strong Mori=GIT}
Two line bundles $L, M$ on $X$ are strongly Mori equivalent if and only if
$U_{\ev_{L}}=U_{\ev_{M}}$ i.e. $\ev_L$ and $\ev_M$ are GIT equivalent.
It is also equivalent to saying that the two line bundles are contained in
the relative interior of the same cone of $\Fan{(X)}$.
\end{prop}

\begin{proof}
The last line follows from Proposition \ref{fan vs strong Mori equivalence}.
For the first line, the arguments in \cite[Proof of Theorem 2.3]{hk} literally works:
in the proof they only proved that the relative interiors of the Mori chambers are
identified (via $\psi$) with the GIT chambers, but the arguments can be applied
more generally for arbitrary strong Mori equivalence classes. 

We only sketch the proof (see \cite[Proof of Theorem 2.3]{hk} for detail).

Fix a character $\chi$ which corresponds to an ample line bundle on $X$.
For an arbitrary character $y\in C^{T}(V)\cap\chi{(T)}$, let
$\psi{(y)}=P+N$ be the Zariski decomposition of the corresponding $\bq$-line bundle.

Then we can show that
\begin{equation*}
U_{\chi}\setminus U_{y}=q_{\chi}^{-1}(\Supp{(N)})
\end{equation*}
holds in codimension one.

This follows from the following equality
\begin{equation*}
H^0(X,\OO_X(m\psi{(y)}))=H^0(U_{\chi},L_{y}^{\otimes m})^{T},
\end{equation*}
which is the same equation as (2.3.2) in \cite[Proof of Theorem 2.3]{hk}, as pointed out
there. From this
we can immediately conclude that GIT equivalence implies the strong Mori equivalence.
Conversely if we assume the strong Mori equivalence of $\psi{(y)}$ and $\psi{(z)}$ for two characters $y$ and $z$,
then we see that $Q_y=Q_z$ and that $U_y$ and $U_z$ coincide in codimension one. The rest of the arguments
is precisely the same as in \cite[Proof of Theorem 2.3]{hk}.
\end{proof}

\begin{cor}\label{cell=GIT equivalence}
Any GIT equivalence class is contained in a GIT cell. Combined with
(\ref{cell to GIT equivalence}) of Lemma \ref{VGIT lemmas}, this means that a GIT equivalence class and
 a cell are the same thing in this case.
 \end{cor}
 \begin{proof}
 Take $\sigma\in\Fan{(X)}$. If $\sigma^{relint}$ is not contained in a cell, the stable loci are not constant
 on it: i.e. there exists a point $x\in V_X$ such that
 $\mathcal{D}_x^{\circ}\cap\sigma^{relint}\not=\emptyset$ but $\sigma^{relint}\not\subset\mathcal{D}_x^{\circ}$.
 Since $\mathcal{D}_x$ and $\sigma$ are rational polyhedral cones, this means
 $\sigma^{relint}\not\subset\mathcal{D}_x$, contradicting the fact that $\sigma^{relint}$ is a GIT equivalence class.
 \end{proof}
 
 \begin{ques}
 Our proof of Corollary \ref{cell=GIT equivalence} relies on the explicit description of GIT equivalence classes, hence
 is valid only for VGIT of Cox rings. It would be interesting to generalize the corollary to arbitrary VGIT of torus actions
 on affine varieties. 
 \end{ques}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Comparison of the fans -via GIT-}\label{Comparison of the fans -via GIT-}

In this section we prove Theorem \ref{fans} via the GIT interpretation of the relative interiors of the cones
(see Proposition \ref{strong Mori=GIT}).

To carry out the proof, we prepare some notations.
Let $f:X\to Y$ be a surjective morphism between MDSs. Fix a subgroup $\Gamma\subset\Divi{(Y)}$
of rank $\rho{(Y)}$ which maps injectively to $\Pic{(Y)}_{\bq}$. Fix also a subgroup
$\Gamma_{X}\subset\Divi{(X)}$ of rank $\rho{(X)}$ mapping injectively to $\Pic{(X)}_{\bq}$, and
$f^{*}\Gamma\subset\Gamma_{X}$.

For such a pair of $(\Gamma, \Gamma_{X})$, the natural ring homomorphism $f^{*}: R_{Y}(\Gamma)
\to R_{X}(\Gamma_{X})$ induces the morphism of affine varieties
\begin{equation*}
V_f:V_X=\Spec R_{X}(\Gamma_{X})\to V_Y=\Spec R_{Y}(\Gamma).
\end{equation*}

Set $T_X=\Hom(\Gamma_{X},k^{*})$ and $T_Y=\Hom(\Gamma,k^{*})$. Via $f^{*}\Gamma\subset\Gamma_{X}$,
we obtain the surjective morphism of algebraic tori $T_f:T_X\to T_Y$.
$T_X$ (resp. $T_Y$) acts on $V_X$ (resp. $V_Y$) via the grading, and $V_f$ is an equivariant morphism
with respect to these actions of tori and $T_f$.



The following is the main ingredient of the proof of Theorem \ref{fans}:
\begin{prop}\label{ss loci and pull back}
Let $f:X\to Y$ be a surjective morphism between MDSs. 
Then if we choose an appropriate pair
$(\Gamma, \Gamma_{X})$ as above, the following holds:

Let $V_f:V_X\to V_Y$ be the associated morphism, and $\ev_{L}\in\chi{(T_Y)}$ be the
character corresponding to a line bundle $L$ on $Y$. Then
\begin{equation}
V_f^{-1}(V_Y^{ss}(\ev_L))=V_X^{ss}(\ev_{f^{*}L})
\end{equation}
holds. 
\end{prop}

\begin{rem}
\begin{equation*}
V_f^{-1}(V_Y^{sss}(\ev_L))=V_X^{sss}(\ev_{f^{*}L})
\end{equation*}
is not correct in general.

The conclusion of Proposition \ref{ss loci and pull back} does not hold for an arbitrary equivariant morphism
between affine varieties. For example, consider the morphism
\begin{equation*}
\varphi:\mathbb{A}^{n}\to\mathbb{A}^{1};(x_1,\dots,x_n)\mapsto x_1,
\end{equation*}
action of $\mathbb{G}_m$ on both sides with weights one, and the character $\chi$ of weight one.
Then
\begin{equation*}
(\mathbb{A}^{n})^{ss}(\chi)=\mathbb{A}^{n}\setminus\{0\}\supsetneq(\mathbb{A}^{1}\setminus\{0\})\times\mathbb{A}^{n-1}
=\varphi^{-1}((\mathbb{A}^{1})^{ss}(\chi)).
\end{equation*}
\end{rem}

The following is the GIT counterpart of Theorem \ref{comparing strong Mori equivalence}
\begin{cor}\label{comparing GIT equivalence}
With the same assumptions as above, let $L,M$ be line bundles on $Y$. Then
$V_Y^{ss}(\ev_L)=V_Y^{ss}(\ev_M)$ holds if and only if
$V_X^{ss}(\ev_{f^*L})=V_X^{ss}(\ev_{f^*M})$ holds.
\end{cor}
\begin{proof}
This follows from Proposition \ref{ss loci and pull back} and the surjectivity of $V_f$.
\end{proof}

Now it is clear that Theorem \ref{fans} immediately follows from
Corollary \ref{comparing GIT equivalence}, in view of Proposition \ref{strong Mori=GIT}.

In the rest of this section, we prove Proposition \ref{ss loci and pull back}.
The following lemma is the key to the proof:
\begin{lem}\label{stable loci under finite morphism}
Let $G$ be a reductive group. Let $\pi:Z\to W$ be a finite morphism between affine varieties such that
$G$ acts on $Z$ and $W$ equivariantly. Let $\mathcal{L}$ be a linearization on $W$. Then
\begin{equation*}
\pi^{-1}(W^{ss}(\mathcal{L}))=Z^{ss}(\pi^{*}\mathcal{L})
\end{equation*}
holds.
\end{lem}
\begin{proof}
See the proof for \cite[Theorem 1.19]{git} (and \cite[Appendix to Chapter 1, \S C]{git} for
positive characteristic cases).
\end{proof}

\begin{proof}[Proof for Proposition \ref{ss loci and pull back}]

We need some preparation. Take the Stein factorization
\begin{equation*}
X\xrightarrow[]{g}\tilde{Y}\xrightarrow[]{h}Y 
\end{equation*}
of $f$.
Fix a subgroup $\Gamma_{\tilde{Y}}\subset\Divi{(\tilde{Y})}$ of rank $\rho(\tilde{Y})$ which maps 
injectively to $\Pic{(\tilde{Y})}_{\bq}$ and containing $h^{*}\Gamma$.
Similarly take $\Gamma_{X}\subset\Divi{(X)}$ of rank $\rho(X)$ which maps 
injectively to $\Pic{(X)}_{\bq}$ and containing $g^{*}\Gamma_{\tilde{Y}}$.
Define groups $Q$ and $R$ by the following exact sequences:
\begin{eqnarray*}
0\to\Gamma\xrightarrow[]{h^*}\Gamma_{\tilde{Y}}\to Q\to 0 \\
0\to\Gamma_{\tilde{Y}}\xrightarrow[]{g^*}\Gamma_{X}\to R\to 0. \\
\end{eqnarray*}
%We further assume that $Q$ and $R$ are torsion free, so that
Taking the duals of these sequences, we obtain the following exact sequences of algebraic tori:
\begin{eqnarray*}
0\to T_Q\to T_{\tilde{Y}}\to T_Y\to 0 \\
0\to T_R\to T_X\to T_{\tilde{Y}}\to 0. \\
\end{eqnarray*}

In particular, we obtain the following sequence of surjective group homomorphisms
\begin{equation}\label{group homomorphisms}
T_X\xrightarrow[]{T_g} T_{\tilde{Y}}\xrightarrow[]{T_h} T_Y.
\end{equation}

Next consider the following diagram.

$\xymatrix{
V_X \ar[d]_{\pi_{R}}^{/T_R} & & \\
J \ar[r]_{\cong} & V_{\tilde{Y}} \ar[d]_{\pi_{Q}}^{/T_Q} & \\
& I \ar[r]_{\textrm{finite}}^{F} & V_Y  \\}$

In the diagram above $I=\Spec{(R_{\tilde{Y}}(h^{*}\Gamma))}$ and
$J=\Spec{(R_X(g^{*}\Gamma_{\tilde{Y}}))}$, and $\pi_R$ and $\pi_Q$ are
natural projections. It is easy to see that they are categorical quotients by
$T_R$ and $T_Q$, respectively.

Note that $T_X$ acts on $V_X$, $T_{\tilde{Y}}$ on $J$ and $V_{\tilde{Y}}$, and
$T_Y$ on $I$ and $V_Y$. Moreover these actions are compatible with respect to the
group homomorphisms (\ref{group homomorphisms}). Since these homomorphisms are
surjective, semi-stability of points on $V_Y$ with respect to the action of $T_Y$ is equivalent
to the semi-stability with respect to the action of $T_X$ (similar for the points on
$I,V_{\tilde{Y}}$, and $J$ respectively).

Now we go back to the proof of Proposition \ref{ss loci and pull back}.

By Lemma \ref{stable loci under finite morphism}, we see that
\begin{equation*}
F^{-1}(V_Y^{ss}(ev_L))=I^{ss}(ev_{h^{*}L})
\end{equation*}
holds, since $I\to V_Y$ is finite (Theorem \ref{finite}).

Next we prove the following
\begin{claim}\label{essentially the same thing}
\begin{equation*}
\pi_Q^{-1}(I^{ss}(ev_{h^{*}L}))=V_{\tilde{Y}}^{ss}(ev_{h^{*}L}).
\end{equation*}
\end{claim}
\begin{proof}[Proof of the claim]
The inclusion $\subseteq$ is the direct consequence of the definition of semi-stability,
since $\pi_Q$ is affine. Conversely, suppose that $x\in V_{\tilde{Y}}^{ss}(ev_{h^{*}L})$. Then
there exists a non-zero section $s\in R_{\tilde{Y}}(\Gamma_{\tilde{Y}})$ which is
semi-invariant with respect to the character $ev_{h^{*}L}$ and $s(x)\not=0$ holds.
Note that semi-invariance of $s$ with respect to the character $ev_{h^{*}L}$ and the
action of $T_{\tilde{Y}}$ implies that $s$ is the global section of some positive multiple of
$h^{*}L$, hence $s\in R_{\tilde{Y}}(h^{*}\Gamma)$. Thus we obtain the other inclusion.
\end{proof}

Since $J\to V_{\tilde{Y}}$ is isomorphic, there is nothing to argue.

By arguing as in Claim, we can show that
\begin{equation*}
\pi_R^{-1}(J^{ss}(ev_{f^{*}L}))=V_X^{ss}(ev_{f^{*}L})
\end{equation*}
holds. Summing up, we obtain the desired equality.
\end{proof}



%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Examples}\label{Examples}

\begin{exmp}\label{bl-up of P^3}
We borrow from \cite[Example 5.5]{aw}.

Let $X$ be the blow-up of $\mathbb{P}^3$ in two distinct points, say $p_1$ and $p_2$. $X$ is
toric, hence is a MDS. Let 
$E_1,E_2$ be the exceptional divisors corresponding to $p_1,p_2$ respectively, and
let $\ell$ be the line passing through the points $p_1,p_2$.
Let $E_3$ be the class of the strict transformation of a plane containing $\ell$.
We can show that $X$ has a flopping contraction which contracts
the strict transformation of the line $\ell$. Let $X'$ be the flop. Using the toric description,
we see that this is an Atiyah flop.

The effective cone of $X$ is spanned by the divisors $E_i$, and
the movable cone is the union of the semi-ample cones of $X$ and $X'$.
$\SA{(X)}$ is spanned by three divisors $H,H-E_1$, and $H-E_2$. $\SA{(X')}$ is
spanned by $H-E_1,H-E_2$, and $E_3$.

A slice of $\Eff{(X)}$, together with its Mori chamber decomposition is described
in the following figure:

\vspace{5mm}
%fig
%%%%%%%%

$\begin{xy}
(0,0)="A"*{\bullet},
"A"+<6cm,0cm>="B"*{\bullet},
"A"+<3cm,4cm>="C"*{\bullet},
"A"+<1.5cm,2cm>="D"*{\bullet},
"D"+<3cm,0cm>="E"*{\bullet},
"A"+<3cm,1.33333cm>="F"*{\bullet},
(0,-4)="E_1"*{E_1},
"B"+(0,-4)="E_2"*{E_2},
"C"+(0,4)="E_3"*{E_3},
"D"+(-10,0)="H-E_2"*{H-E_2},
"E"+(10,0)="H-E_1"*{H-E_1},
"F"+(0,-4)="H"*{H},
"F"+(0,4)="SA(X)"*{\SA{(X)}},
"F"+(0,12)="SA(X')"*{\SA{(X')}},
"A"+<2cm,0.888889cm>="T",
"A"+<3cm,-1cm>="S",
"S"+(1,-3)*{\Eff{(Y)}}
\ar"S";"T"
\ar@{-}"A";"B"
\ar@{-}"A";"C"
\ar@{-}"B";"C"
\ar@{=}"A";"E"
\ar@{-}"B";"D"
\ar@{-}"D";"E"
\end{xy}$
\vspace{5mm}


%%%%%%%


Let $Y$ be the blow-up of $\mathbb{P}^3$ in $p_1$. Then the effective cone of $Y$, together with
its decomposition into Mori chambers sits in $\Eff{(X)}$ as indicated in the figure above ($\Eff{(Y)}$ is
denoted by the double line).

As indicated in the figure above, $\Eff{(Y)}$ is mapped onto the cone spanned by
$E_1$ and $H-E_1$. The cone spanned by $H$ and $H-E_1$ is the semi-ample cone of $Y$, and
that spanned by $H$ and $E_1$ corresponds to the Mori chamber of $Y$ whose interior points
correspond to the line bundles defining the birational contraction to $\mathbb{P}^3$.

Now take a coordinate on $\mathbb{P}^3$ such that $p_1=(0:0:0:1)$ and $p_2=(0:0:1:0)$. Consider the
action of $\bz_2$ on $\mathbb{P}^3$ defined by $(x:y:z:w)\mapsto (x:y:w:z)$. This action lifts to
$X$, and let $X\to Z$ be the quotient
morphism. The effective cone of $Z$ together with its Mori chamber decomposition
sits in that of $X$ as follows ($\Eff{(Z)}$ is
denoted by the double line):


\vspace{5mm}
%fig
%%%%%%%%
$\begin{xy}
(0,0)="A"*{\bullet},
"A"+<6cm,0cm>="B"*{\bullet},
"A"+<3cm,4cm>="C"*{\bullet},
"A"+<1.5cm,2cm>="D"*{\bullet},
"D"+<3cm,0cm>="E"*{\bullet},
"A"+<3cm,1.33333cm>="F"*{\bullet},
"A"+<3cm,0cm>="G"*{\bullet},
"A"+<3cm,2cm>="I"*{\bullet},
(0,-4)="E_1"*{E_1},
"B"+(0,-4)="E_2"*{E_2},
"C"+(0,4)="E_3"*{E_3},
"D"+(-10,0)="H-E_2"*{H-E_2},
"E"+(10,0)="H-E_1"*{H-E_1},
"F"+(5,0)="H"*{H},
"G"+(0,-4)="E_1+E_2"*{E_1+E_2},
"C"+<0cm,-1cm>="T",
"T"+<1cm,0cm>="S",
"S"+(10,0)="Eff{(Z)}"*{\Eff{(Z)}},
\ar"S";"T"
\ar@{-}"A";"B"
\ar@{-}"A";"C"
\ar@{-}"B";"C"
\ar@{-}"A";"E"
\ar@{-}"B";"D"
\ar@{-}"D";"E"
\ar@{=}"G";"C"
\end{xy}$
\vspace{5mm}

As indicated in the diagram above, we can see that $Z$ has two Mori chambers other than
the semi-ample cone (recall that $\SA{(Z)}$ coincides with the restriction of $\SA{(X)}$ to
$\Pic{(Z)}_{\br}$. See Lemma \ref{direct}(1)).

Let $Z'$ be the quotient of $X'$ by the involution induced from that on $X$.
Again by Lemma \ref{direct}(1), we can check that the Mori chamber of $Z$ obtained by restricting $\SA{(X')}$ is the
semi-ample cone of $Z'$. The morphism defined by the ray separating $\SA{(Z)}$ and
$\SA{(Z')}$ is the flipping contraction of $Z$ which contracts the image of $\ell$ under the quotient
morphism $X\to Z$, and $Z'$ is the flip. 

This example shows that a Mori chamber of the target space $Z$ is not necessarily a face of
a Mori chamber of the source $X$.
\end{exmp}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{exmp}\label{globally F-regular is not preserved}
This example is well-known to experts, but we give a detailed explanation for the sake of completeness.
The author learned this example from Doctor Tadakazu Sawada.

Suppose that $p>0$. Let $\mathbb{A}^{2}_{x,y}\subset\mathbb{P}^2$ be an standard embedding of affine $2$-plane
with coordinate functions $x$ and $y$. Take $f=f(x,y)\in k[x,y]$.
Consider the rational vector field defined by
\begin{equation*}
\delta=\frac{\partial f}{\partial y}\frac{\partial}{\partial x}-\frac{\partial f}{\partial x}\frac{\partial}{\partial y}.
\end{equation*}
According to \cite{rs}, we obtain the quotient of $\mathbb{P}^2$ by $\delta$.
That is, we obtain a purely inseparable finite morphism $\pi:\mathbb{P}^2\to Y$ of degree $p$
to a normal projective variety $Y$ such that $\OO_Y=\OO_{\mathbb{P}^2}^{\delta}$.
It is easy to see that $k[x,y]^{\delta}=k[x^p,y^p,f(x,y)]\simeq k[X,Y,Z]/(Z^p-f(X,Y))$ holds.

Set $f(x,y)=x^py+xy^p$. By the Fedder's criterion for $F$-purity (\cite[Proposition 1.7]{fe}),
we can check that
the singularity $(0\in k[x,y]^{\delta})\cong k[[X,Y,Z]]/(Z^p-X^pY-XY^p)$ is not $F$-pure.
Therefore $Y$ is not globally $F$-regular, despite $\mathbb{P}^2$ is.

On the other hand we can show that $Y$ is a MDS.
Firstly Picard number of $Y$ is one since $\pi^{*}:\Pic{(Y)}_{\br}\to \Pic{(\mathbb{P}^{2})}_{\br}$ is
injective. We can also check that $Y$ is $\bq$-factorial:
\begin{claim}
Let $f:X\to Y$ be a purely inseparable finite morphism between normal varieties. If $X$ is $\bq$-factorial, so is
$Y$.
\end{claim}

\begin{proof}
Everything follows from the following subclaim, which can be shown easily:
\begin{subclaim}
Under the same assumptions, let $(U,f_U)_U$ be a Cartier divisor on $X$, where $X=\bigcup U$ is an
open covering of $X$ and $f_U\in k(X)$. Then the pushforward of the Weil divisor corresponding to
$(U,f_U)_U$ corresponds to the Cartier divisor $(U,N(f_U))_{U}$, where $N=N_{X/Y}:k(X)\to k(Y)$ is the
norm function.
\end{subclaim}

Let $D$ be a Weil divisor on $Y$. By assumption, there exists a positive integer $m$ such that
$mf^{*}D=f^{*}mD$ is Cartier. By the subclaim above, we can show that
$f_{*}f^{*}mD=m\deg{(f)}D$ and that $f_{*}f^{*}mD$ is Cartier.
\end{proof}
\end{exmp}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Amplifications}\label{Amplifications}

In this section, we extend our results
\begin{itemize}
\item to the case when varieties involved are not necessarily $\bq$-factorial.
\item to Mori dream regions.
\end{itemize}
As an example of a Mori dream region, we treat the Shokurov polytopes in the final subsection.

\subsection{Non-$\bq$-factorial MDS}\label{Non-Q-factorial MDS}
In \cite[\S 2]{ahl}, the notion of MDS has been extended to not necessarily $\bq$-factorial normal projective varieties.
In this subsection we call them non-$\bq$-factorial MDS, and
show that our main results are also valid in that context.

\begin{defi}\label{nQfMDS}
Let $X$ be a normal projective variety. $X$ is said to be a non-$\bq$-factorial MDS if
\begin{enumerate}
\item $\Cl{(X)}$ is finitely generated, where $\Cl{(X)}$ denotes the
Weil divisor class group of $X$.
\item A Cox ring of $X$ (see below for the definition) is of finite type over the base field.
\end{enumerate}
\end{defi}
\begin{defi}
Let $X$ be a normal projective variety with finitely generated $\Cl{(X)}$.
Let $\Gamma\subset\WDivi{(X)}$ be a finitely generated subgroup of rank $\dim_{\bq}\Cl{(X)}_{\bq}$ which maps
injectively to $\Cl{(X)}_{\bq}$. A Cox ring of $X$ is the multi-section ring
\begin{equation*}
R_{X}(\Gamma)=\bigoplus_{D\in\Gamma}H^0(X,\OO_{X}(D))
\end{equation*}
for such $\Gamma$.
\end{defi}
Note that our definitions of non-$\bq$-factorial MDS and Cox rings coincide with those of
$bq$-factorial MDSs when the variety is $\bq$-factorial.
Note also that the finite generation of a Cox ring is independent of the choice of $\Gamma$.

\begin{rem}
Our definition of a Cox ring is different from that in \cite[\S 2]{ahl}, but they differ up to taking the quotient
by a finite group. The properties we are interested in, like finite generation, are invariant under such operations,
so there is no significant difference between them.

In the proof of \cite[Lemma 2.4]{ahl}, they used 
the characteristic zero assumption so that they can apply the existence of resolutions.
Actually we can avoid the use of resolutions as follows, so that their results work in arbitrary characteristics.

\begin{proof}
We give a proof of \cite[Lemma 2.4]{ahl} which works in arbitrary characteristics.

Take prime divisors $D_1,\dots,D_r$ on $X$ which generates $\Cl{(X)}$.
Let $X'\to X$ be a birational proper morphism from a projective variety $X'$, whose existence is
guaranteed by the Chow's lemma.
Let $D_i'$ be the strict transforms $D_i$s.
Now let $X''\to X'$ be (the normalization of) the successive blow-ups of $X'$ along $D_i'$s.
Let $D_i''$ be the total transform of $D_i'$. Note that $D_i''$ is a Cartier divisor by the construction
of blow-up.
Let $f:X''\to X$ be the composition of the two morphisms, and note that $f_{*}D_i''=D_i$ holds.

If we regard $f$ as the birational morphism $\pi$ in the proof of \cite[Lemma 2.4]{ahl}, the rest of the arguments works similarly.
\end{proof}

\end{rem}


We go back to our results. First, Theorem \ref{main} also holds in this case:
\begin{theo}\label{main'}
Let $X$ be a non-$\bq$-factorial MDS, and $X\to Y$ be a surjective morphism to another
normal projective variety. Then $Y$ also is a non-$\bq$-factorial MDS.
\end{theo}
\begin{proof}
The proof is essentially the same as that for Theorem \ref{main}, so we only point out where should be
modified in the original one.
First of all, we can replace $X$ with its small $\bq$-factorization: i.e.
there exists a small birational morphism $\tilde{X}\to X$ from a $\bq$-factorial normal projective variety
$\tilde{X}$. This fact implicitly appears in \cite[Theorem 2.3]{ahl} and its proof.

We should check that $\dim_{\bq}\Cl{(Y)}_{\bq}<\infty$. Note that $\Cl{(Y)}$ does not change
if we remove the singular locus of $Y$. If we remove the inverse image of this locus from $X$, the
Weil divisor class group does not increase. The rest of the argument is the same.

In order to prove the finite generation of a Cox ring of $Y$, we take the Stein factorization of $X\to Y$
as before.

Nothing has to be changed for finite morphisms.
For algebraic fiber spaces, we again remove the singular locus of $Y$ and its inverse image.
Then we can apply Lemma \ref{afs}, since any Weil divisor on a non-singular variety is Cartier so that
it can be pulled-back.
\end{proof}

For a non-$\bq$-factorial MDS $X$, we can define the notion of Mori equivalence, Mori chambers and so on
exactly in the same manner as before. On the other hand, we can take a small $\bq$-factorization $\tilde{X}\to X$
and the divisor class group and Mori equivalence do not change under this operation. Therefore we obtain
\begin{theo}\label{fans'}
Let $X\to Y$ be a surjective morphism between non-$\bq$-factorial MDSs. Then
\begin{equation*}
\Fan{(Y)}=\Fan{(X)}|_{\Cl{(Y)}_{\br}}
\end{equation*}
holds.
\end{theo}
\begin{proof}
By taking suitable small $\bq$-factorizations of $X$ and $Y$, the morphism lifts to the one between
ordinary MDSs. Thus we can reduce the problem to our original Theorem \ref{fans}.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Mori dream regions}\label{Mori dream regions}

Let $X$ be a normal $\bq$-factorial projective variety.


There is a notion called Mori dream regions (MDR, for short) defined in \cite[Definition 2.12]{hk},
which generalizes MDSs. In this subsection we check that our main results can be extended to
MDRs.

First we recall the definition of MDRs from \cite[Definition 2.12]{hk}:
\begin{defi}\label{MDR}
Let $X$ be a normal $\bq$-factorial projective variety. A cone $\mathcal{C}\subset\Pic{(X)}_{\br}$
spanned by finitely many line bundles is called a Mori dream region (MDR) if
the multi-section ring
\begin{equation*}
R_{X}(\mathcal{C})=\bigoplus_{D\in\mathcal{C}}H^{0}(X,\OO_{X}(D))
\end{equation*}
is of finite type over the base field.
\end{defi}

If the natural morphism $\Pic{(X)}_{\bq}\to\Num{(X)}_{\bq}$ is isomorphic and $\mathcal{C}=\Eff{(X)}$, $\mathcal{C}$ is
a MDR if and only if $X$ is a MDS.


As in the case of MDS, MDR can be characterized via the existence of a decomposition into
finitely many rational polyhedral subcones such that on each of them the Zariski decomposition is
$\bq$-linear:

\begin{prop}\label{MDR and ZD}
Let $X$ be a normal $\bq$-factorial projective variety and $\mathcal{C}\subset\Pic{(X)}_{\br}$ be a cone
spanned by finitely many line bundles. It is a MDR if and only if the following conditions are satisfied:
\begin{itemize}
\item $\mathcal{C}\cap\Eff{(X)}$ is spanned by finitely many line bundles.
\item The section ring of any line bundle of $\mathcal{C}\cap\Eff{(X)}$ is of finite type over the base field.
In particular, those line bundles admit the Zariski decompositions
(see \S\ref{Zariski decompositions and the fan}).
\item There exists a decomposition of $\mathcal{C}\subset\Pic{(X)}_{\br}$ into finitely many
rational polyhedral subcones such that on each of them the Zariski decomposition is $\bq$-linear.
\end{itemize}
\end{prop}
\begin{proof}
`if' part is exactly the same as the proof of Lemma \ref{afs}.
For the `only if' part, the second condition follows from \cite[`If' part of Lemma 1.6]{hk}. For the first and
the third conditions, see \cite[Theorem 3.5]{cl}.
\end{proof}


\begin{rem}
In \cite[Theorem 2.13]{hk}, they claim that we can find a decomposition of $\mathcal{C}$ into
chambers $\mathcal{C}_i$ so that for each of them
we can find a contracting birational map
$g_i:X\dasharrow Y_i$ such that
\begin{equation*}
\mathcal{C}_i=\mathcal{C}\cap\left(g_i^{*}\Nef{(Y_i)}*\ex{(g_i)}\right)
\end{equation*}
holds.

The author believe that it is not so easy to prove, since using that claim we can derive
the existence of a minimal model from that of the canonical model.
This is why he replaced \cite[Theorem 2.13]{hk} with Proposition \ref{MDR and ZD}.

\end{rem}

We can introduce the notion of Mori equivalence and the fan structure on MDRs
exactly in the same way as before, and
our main results also generalizes. For a normal $\bq$-factorial projective variety $X$ and
a MDR $\mathcal{C}$, we denote thus defined fan structure on $\mathcal{C}$ by $\Fan{(X;\mathcal{C})}$.
Then
\begin{cor}\label{main''}
Let $f:X\to Y$ be a surjective morphism between normal $\bq$-factorial projective varieties.
Let $\mathcal{C}\subset \Pic{(X)}_{\br}$
be a finitely generated rational polyhedral cone which is a MDR. Then
$\mathcal{C}|_{\Pic{(Y)}_{\br}}$ also is a MDR.
\end{cor}
\begin{cor}\label{fans''}
Let $f:X\to Y$ as above, and set $\mathcal{C}'=\mathcal{C}|_{\Pic{(Y)}_{\br}}$. Then
$\Fan{(X;\mathcal{C})}|_{\Pic{(Y)}_{\br}}=\Fan{(Y;\mathcal{C}')}$ holds.
\end{cor}
They can be proved exactly in the same manners as in those for Theorem \ref{main} and \ref{fans}.

\subsection{Application to Shokurov polytopes}\label{Application to the Shokurov polytopes}
We consider an application to the Shokurov polytopes.
\begin{exmp}\label{multi-adjoint rings}
Suppose that $p=0$, $X$ be a $\bq$-factorial normal projective variety and $\Delta_{i}$
($i=1,2,\dots,N$) be effective divisors on $X$ such that ($X,\Delta_{i}$) are klt.
We consider the case when the cone $\mathcal{C}$ spanned by the divisors $(K_X+\Delta_{i})$ is a MDR.
In \cite{bchm}, it was proven that it is the case when the boundary divisors $\Delta_i$ are big.
This is expected to be true without the bigness assumption, but it still is widely open.

Here we note that for this $\mathcal{C}$, the fan structure $\Fan{(X;\mathcal{C})}$ is the same as
the decomposition discussed in \cite{ka}.

Suppose that a minimal model and the canonical model
exists for any log canonical divisor in $\mathcal{C}$. Note that this implies that $\mathcal{C}$ is a MDR.
In this situation, subcone $V_j$ of $\mathcal{C}$ defined in \cite[Theorem 3]{ka}, which is a cone of
log canonical divisors with the same log canonical models,
is a Mori equivalence class. Moreover subcone $W_{j,k}$ of $V_j$ in \cite[Theorem 4]{ka}, which
is a cone of log canonical divisors sharing the same log canonical model and a minimal model,
is a strong Mori equivalence class: i.e. the relative
interior of a cone of  $\Fan{(X;\mathcal{C})}$.

Let $X\to Y$ be a surjective morphism.
From our Corollary \ref{main''} and \ref{fans''}, the restriction $\mathcal{C}'$ of $\mathcal{C}$ to $\Pic{(Y)}_{\br}$ again
is a MDR and its fan structure comes from that of $\mathcal{C}$. Using the Stein factorization and
the adjunction theorems \cite[Theorem 4.1]{a} and \cite[Lemma 1.1]{fg}, we can easily see that $\mathcal{C}'$
is also spanned by finitely many klt log canonical divisors. In view of this,
our Corollary \ref{fans''} applied to this case can be interpreted as the comparison theorem of
log minimal (resp. log canonical) models of $X$ and $Y$.
\end{exmp}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%Bibliography%%%%%%
\begin{thebibliography}{HK}

\bibitem[A]{a} F. Ambro, \textit{The moduli b-divisor of an lc-trivial fibration},
Compos. Math. \textbf{141} (2005), no. 2.

\bibitem[AHL]{ahl} M. Artebani, J. Hausen, and A. Laface, \textit{On Cox rings of K3 surfaces},
Compos. Math. \textbf{146} (2010), no. 4.

\bibitem[ADHL]{adhl} I. Arzhantsev, U. Derenthal, J. Hausen, and A. Laface,
\textit{Cox rings}, arXiv:1003.4229.

\bibitem[AW]{aw} K. Altmann and J. Wi\'{s}niewski, \textit{P-divisors of Cox rings},
arXiv:0911.5167.


\bibitem[B]{b} H. B\"{a}ker, \textit{Good quotients of Mori dream spaces},
to appear on Proc. Amer. Math. Soc.; also available on arXiv:1003.3408.


\bibitem[BCHM]{bchm} C. Birkar, P. Cascini, C. Hacon, and J. McKernan,
\textit{Existence of minimal models for varieties of log general type},
J. Amer. Math. Soc. \textbf{23} (2010), no. 2.

\bibitem[CL]{cl} A. Corti, V. Lazic, \textit{New outlook on Mori theory, II},
arXiv:1005.0614v2.

\bibitem[DH]{dh} I. Dolgachev and Y. Hu, \textit{Variation of geometric invariant theory quotients},
Inst. Hautes \'{E}tudes Sci. Publ. Math. No. 87 (1998).

\bibitem[E]{e} D. Eisenbud, \textit{Commutative algebra. With a view toward algebraic geometry},
Graduate Texts in Mathematics, 150. Springer-Verlag, New York, 1995.

\bibitem[F]{fe} R. Fedder, \textit{F-purity and rational singularity},
 Trans. Amer. Math. Soc. \textbf{278} (1983), no. 2.

\bibitem[FG]{fg} O. Fujino and Y. Gongyo, \textit{On canonical bundle formulae and subadjunctions},
to appear on Mich. Math. J.; also available on arXiv:1009.3996.

\bibitem[Fu1]{f} W. Fulton, \textit{Intersection theory. Second edition},
Ergebnisse der Mathematik und ihrer Grenzgebiete. 3. Folge. A Series of Modern Surveys in Mathematics,
2. Springer-Verlag, Berlin, 1998.

\bibitem[Fu2]{f2} W. Fulton, \textit{Introduction to toric varieties},
Annals of Mathematics Studies, 131,
The William H. Roever Lectures in Geometry, Princeton University Press, Princeton, NJ, 1993.
 
\bibitem[FGA]{fga} B. Fantechi, L. G\"{o}ttsche, L. Illusie, S. Kleiman, N. Nitsure, and A. Vistoli,
\textit{Fundamental algebraic geometry. Grothendieck's FGA explained},
Mathematical Surveys and Monographs, 123. American Mathematical Society,
Providence, RI, 2005.

\bibitem[GIT]{git} D. Mumford, J. Fogarty, and F. Kirwan, \textit{Geometric invariant theory,
Third edition}, Ergebnisse
der Mathematik und ihrer Grenzgebiete (2), vol. 34, Springer-Verlag, Berlin, 1994.

\bibitem[HK]{hk} Y. Hu and S. Keel, \textit{Mori Dream Spaces and GIT}, Michigan Math. J. \textbf{48} (2000).

\bibitem[Ka]{ka} Y. Kawamata, \textit{Remarks on the cone of divisors},
arXiv:0909.3621v1.


\bibitem[K]{k} A. King, \textit{Moduli of representations of finite-dimensional algebras},
Quart. J. Math. Oxford Ser. (2) \textbf{45} (1994), no. 180.

\bibitem[L]{l} R. Lazarsfeld, \textit{Positivity in algebraic geometry I}, Ergebnisse der Mathematik und
ihrer Grenzgebiete. 3. Folge. A Series of Modern Surveys in Mathematics, 48. Springer-Verlag, Berlin, 2004. 


\bibitem[RS]{rs} A. N. Rudakov and I. R. \v{S}afarevi\v{c}, \textit{Inseparable morphisms of
algebraic surfaces}, Math. USSR Izv. \textbf{10} (1976), 1205--1237.

\bibitem[SS]{ss} K. Schwede and K. Smith, \textit{Globally $F$-regular and log Fano varieties},
Adv. Math. \textbf{224} (2010), no. 3.

\end{thebibliography}


 \end{document}